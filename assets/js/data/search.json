[
  
  {
    "title": "ì‹ ì… í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìì˜ MVVM íŒ¨í„´ ì ìš©ê¸°",
    "url": "/posts/apply-mvvm-design/",
    "categories": "typescript, react, frontend",
    "tags": "design-pattern, mvvm",
    "date": "2024-03-26 10:47:00 +0900",
    





    
    "snippet": "MVVM íŒ¨í„´ì€ ë””ìì¸ íŒ¨í„´ì˜ í•œ ì¢…ë¥˜ë¡œ, Model, View, ViewModelì„ ì‚¬ìš©í•´ UI ê´€ë ¨ ë¡œì§ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ëª…í™•í•˜ê²Œ ë¶„ë¦¬í•©ë‹ˆë‹¤. ì·¨ì—…ì„ ì¤€ë¹„í•˜ë˜ ì‹œê¸°ì— ì§„í–‰í–ˆë˜ í† ì´ í”„ë¡œì íŠ¸ëŠ” ê·œëª¨ê°€ ì‘ì•„ ì´ëŸ¬í•œ íŒ¨í„´ì„ ì ìš©í•  í•„ìš”ì„±ì„ ëŠë¼ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìë¡œ ì¼ì„ ì‹œì‘í•˜ê³  ì‚¬ìš©ìë“¤ì´ ì‚¬ìš©í•  ì‹¤ì œ ì„œë¹„ìŠ¤ë¥¼ ì œì‘í•˜ë©°, ì½”ë“œì˜ ìœ ...",
    "content": "MVVM íŒ¨í„´ì€ ë””ìì¸ íŒ¨í„´ì˜ í•œ ì¢…ë¥˜ë¡œ, Model, View, ViewModelì„ ì‚¬ìš©í•´ UI ê´€ë ¨ ë¡œì§ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ëª…í™•í•˜ê²Œ ë¶„ë¦¬í•©ë‹ˆë‹¤. ì·¨ì—…ì„ ì¤€ë¹„í•˜ë˜ ì‹œê¸°ì— ì§„í–‰í–ˆë˜ í† ì´ í”„ë¡œì íŠ¸ëŠ” ê·œëª¨ê°€ ì‘ì•„ ì´ëŸ¬í•œ íŒ¨í„´ì„ ì ìš©í•  í•„ìš”ì„±ì„ ëŠë¼ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìë¡œ ì¼ì„ ì‹œì‘í•˜ê³  ì‚¬ìš©ìë“¤ì´ ì‚¬ìš©í•  ì‹¤ì œ ì„œë¹„ìŠ¤ë¥¼ ì œì‘í•˜ë©°, ì½”ë“œì˜ ìœ ì§€ë³´ìˆ˜ì„±ê³¼ ì¬ì‚¬ìš©ì„±ì„ ë†’ì´ê¸° ìœ„í•´ MVVM íŒ¨í„´ì„ ì ìš©í•´ë³´ëŠ”ê²Œ ì¢‹ì„ê²ƒ ê°™ë‹¤ëŠ” ì½”ë“œë¦¬ë·° í”¼ë“œë°±ì„ ë°›ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹ ì… í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìë¡œì¨ í•œë²ˆë„ ì¨ë³´ì§€ ì•Šì•˜ë˜ MVVM íŒ¨í„´ì„ ì–´ë–»ê²Œ ì½”ë“œì— ì ìš©í–ˆëŠ”ì§€, ë˜ ë¦¬íŒ©í† ë§ì„ ì§„í–‰í•˜ë©° ì–´ë–¤ ë¶€ë¶„ì„ ê³ ë¯¼í–ˆì—ˆëŠ”ì§€ ê¸€ì„ í†µí•´ ë‚˜ëˆ ë³´ê³ ì í•©ë‹ˆë‹¤.ë¦¬íŒ©í† ë§ ê³¼ì •ì´ˆê¸° ì½”ë“œinterface DropdownListProps {  data: string[];  placeholder: string;}function DropdownList(props: DropdownListProps) {  const [isListOpen, setIsListOpen] = useState&lt;boolean&gt;(false);  const [selectedOption, setSelectedOption] = useState&lt;string&gt;(\"\");  const { data, placeholder } = props;  useEffect(() =&gt; {    setSelectedOption(placeholder);  }, []);  return (    &lt;DropdownListContainer onClick={() =&gt; setIsListOpen(!isListOpen)}&gt;      {selectedOption}      {isListOpen ? (        &lt;DropdownListOptionContainer&gt;          {data.map((option) =&gt; (            &lt;DropdownListOption key={option} onClick={() =&gt; setSelectedOption(option)}&gt;              {option}            &lt;/DropdownListOption&gt;          ))}        &lt;/DropdownListOptionContainer&gt;      ) : (        &lt;div /&gt;      )}    &lt;/DropdownListContainer&gt;  );}export default DropdownListê°€ì ¸ì˜¨ ì½”ë“œëŠ” ê³µí†µ ì»´í¬ë„ŒíŠ¸ë¡œ ì œì‘í•œ ë“œë¡­ë‹¤ìš´ ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤. ì œì¼ ì²˜ìŒì— ì‘ì„±í–ˆë˜ ì½”ë“œì¸ë°, ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê³³ì—ì„œ ì„œë²„ ë°ì´í„°ë¥¼ propsë¡œ ë„˜ê²¨ë°›ê³  ê·¸ ë°ì´í„°ë¥¼ ë°”ë¡œ TSXì— ì ìš©í•´ì£¼ëŠ” í˜•ì‹ì…ë‹ˆë‹¤. í•˜ë‚˜ì˜ íŒŒì¼ì—ì„œ ì»´í¬ë„ŒíŠ¸ì˜ ëª¨ë“  ê²ƒì„ ì»¨íŠ¸ë¡¤ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ë‹¹ì—°íˆ UI ë¡œì§ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ êµ¬ë¶„ë˜ì–´ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.ì´ ì»´í¬ë„ŒíŠ¸ì— MVVM íŒ¨í„´ì„ ì ìš©í•´ë³´ë¼ëŠ” ê³¼ì œë¥¼ ë°›ê³  ë¡œì§ì„ ì–´ë–»ê²Œ ë‚˜ëˆ ì•¼ í•˜ë‚˜ ë§ì€ ê³ ë¯¼ì„ í–ˆìŠµë‹ˆë‹¤. Viewê°€ ê°€ì ¸ê°€ì•¼í•˜ëŠ” ë¶€ë¶„ì€ TSXê°€ ë¦¬í„´ë˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ ë¹„êµì  ëª…í™•í•˜ê²Œ ë³´ì˜€ìœ¼ë‚˜, ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ë³´ì´ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ViewModelì„ ì‹¤ì œë¡œ ì–´ë–»ê²Œ êµ¬í˜„í•´ì•¼í•˜ëŠ”ì§€ ê°ì´ ì¡íˆì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ìš°ì„  ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë¶€ë¶„ì„ Modelë¡œ ë¶„ë¦¬í•´ë³´ëŠ” ì¼ë¶€í„° ì‹œì‘í•´ë³´ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤. ViewëŠ” ì–´ëŠì •ë„ ì™„ì„±ì´ ëœ ìƒíƒœì´ë‹ˆ Modelì„ ì‘ì„±í•˜ê³  ë‚˜ë©´ ViewModelì˜ ì—­í• ë„ ë³´ì´ì§€ ì•Šì„ê¹Œ? í•˜ëŠ” ìƒê°ì´ì—ˆìŠµë‹ˆë‹¤.1ì°¨ ë¦¬íŒ©í† ë§// Modelconst rawDataCountries = ['Korea', 'Japan', 'Singapore', 'Australia']interface DropdownListItem {    getTitle: () =&gt; string    isSelected: () =&gt; boolean    setSelected: (isSelected: boolean) =&gt; void    isSelectable: () =&gt; boolean}class DropdownListItemCountry implements DropdownListItem {    private readonly title: string    private selected: boolean    private readonly selectable: boolean = true    constructor(title: string) {        this.title = title        this.selected = false        if (!title) this.selectable = false    }    getTitle = () =&gt; this.title    isSelected = () =&gt; this.selected    setSelected = (selected: boolean) =&gt; {        this.selected = selected    }    isSelectable = () =&gt; this.selectable}interface DropdownListProcessedData {    getCountryList: () =&gt; DropdownListItem[]}class ProcessedData implements DropdownListProcessedData {    private countryList: DropdownListItem[]    constructor() {        this.countryList = rawDataCountries.map(            (item) =&gt; new DropdownListItemCountry(item)        )    }    getCountryList = () =&gt; this.countryList}export default ProcessedData1ì°¨ ë¦¬íŒ©í† ë§ í›„ Modelë¡œ ë¶„ë¦¬í•œ ì½”ë“œì…ë‹ˆë‹¤. ë¬¸ìì—´ ë°°ì—´ í˜•ì‹ì˜ ë”ë¯¸ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ì •ì˜í•´ë‘ê³ , í•´ë‹¹ ë°ì´í„°ê°€ ì„œë²„ì—ì„œ ë„˜ì–´ì™”ë‹¤ê³  ê°€ì •í•œ í›„ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ ë”°ë¡œ ë¶„ë¦¬í•´ë†“ê³  ë‚˜ë‹ˆ, í•´ë‹¹ ì„ íƒì§€ê°€ ì„ íƒì´ ëœ ìƒíƒœì¸ì§€, ì„ íƒì´ ê°€ëŠ¥í•œ ìƒíƒœì¸ì§€ì— ê´€í•œ ì •ë³´ë„ í•¨ê»˜ ë“¤ì–´ìˆìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì†ì„±ìœ¼ë¡œëŠ” ì œê°€ ì›í•˜ëŠ” ì •ë³´ë¥¼ ì €ì¥í•˜ê³ , í–‰ìœ„ëŠ” í•´ë‹¹ ê°ì²´ê°€ ê°€ì§„ ì •ë³´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ ê°ê°ì˜ ì„ íƒì§€ë“¤ì„ ê°ì²´ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤. ì €ëŠ” ê°„ë‹¨í•˜ê²Œ ì–´ë–¤ ì„ íƒì§€ì¸ì§€ ì•Œë ¤ì£¼ëŠ” titleê³¼ í•´ë‹¹ ì„ íƒì§€ê°€ ì„ íƒë˜ì—ˆëŠ”ì§€ ì•Œë ¤ì£¼ëŠ” selected, ì„ íƒì§€ê°€ ì„ íƒì´ ê°€ëŠ¥í•œì§€ ì•Œë ¤ì£¼ëŠ” selectable ì†ì„± ì„¸ ê°œë¥¼ ì •ì˜í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì„¸ ê°œì˜ ì†ì„±ì„ ë¦¬í„´í•´ì£¼ëŠ” ë©”ì„œë“œì™€ ì„ íƒì§€ê°€ ì„ íƒë˜ì—ˆì„ë•Œ selected ì†ì„±ê°’ì„ ë°”ê¿”ì£¼ëŠ” setSelected ë©”ì„œë“œë„ í¬í•¨í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. ë‹¨ìˆœí•˜ê²Œ ì´ë¦„ë§Œ ê°€ì§€ë˜ ì„ íƒì§€ë“¤ì´ selectedì™€ selectable ì†ì„±ì„ ê°€ì§€ê²Œ ë¨ìœ¼ë¡œì¨ ë“œë¡­ë‹¤ìš´ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì–´ë–¤ ì„ íƒì§€ë¥¼ ì„ íƒí–ˆì„ ë•Œ, ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì„ íƒëœ ì˜µì…˜ì„ ë°›ì•„ ì œí’ˆ ëª©ë¡ì„ ë³´ì—¬ì£¼ëŠ” ë“±ì˜ ë°©ë²•ìœ¼ë¡œ ì¬ì‚¬ìš©ë  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.ê·¸ë¦¬ê³  ìµœì¢…ì ìœ¼ë¡œ ê°ê°ì˜ ì„ íƒì§€ ê°ì²´ë“¤ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ëª¨ì•„ì£¼ëŠ” ê°ì²´ë¥¼ ë§Œë“¤ì–´ ViewModelì´ ë°”ë¡œ í™œìš©í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¥¼ ë°˜í™˜í•˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤.// ViewModelimport { useState } from \"react\";import ProcessedData from \"@components/dropdown-list/model\";function DropdownListViewModel() {  const [isListOpen, setIsListOpen] = useState&lt;boolean&gt;(false);  const [selectedCountryOption, setSelectedCountryOption] = useState&lt;string | undefined&gt;(undefined);  const countryList = new ProcessedData().getCountryList();  function handleListDisplay() {    setIsListOpen(!isListOpen);  }  function handleSelectOption(idx: number, list: string) {    if (list === \"countryList\") setSelectedCountryOption(countryList[idx].getTitle());  }  return { countryList, isListOpen, selectedCountryOption, handleListDisplay, handleSelectOption };}export default DropdownListViewModel;Viewì™€ Modelì˜ ìœ¤ê³½ì´ ì¡íˆê³  ë‚˜ë‹ˆ ViewModelë„ êµ¬í˜„ì´ ê°€ëŠ¥í–ˆìŠµë‹ˆë‹¤. Viewì™€ Modelì´ ì§ì ‘ì ìœ¼ë¡œ ì—°ê²°ì´ ëœë‹¤ë©´ ì„œë¡œì— ëŒ€í•œ ì˜ì¡´ì„±ì´ ë†’ì•„ì§€ê¸° ë•Œë¬¸ì—, ë‹¨ìˆœí•œ ì‘ì—…ì´ë¼ë„ ViewModel í†µí•˜ë„ë¡ í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. ViewModelì´ Modelë¡œë¶€í„° ë°ì´í„°ë¥¼ ì „ë‹¬ë°›ì•„ Viewë¡œ ì „ë‹¬í•´ì£¼ê³ , Viewì—ì„œ Modelì„ ë³€ê²½í•˜ëŠ” ì¸í„°ë ‰ì…˜ì´ ì¼ì–´ë‚˜ë©´ ViewModelì„ í†µí•´ Modelì—ê²Œ ë³€ê²½ì ì„ ì•Œë¦¬ê²Œ ë©ë‹ˆë‹¤.// View// ... Styled components ë“± ë‹¤ë¥¸ importë“¤import useDropdownListViewModel from \"@components/dropdown-list/view-model\";interface DropdownListProps {  placeholder: string;}function DropdownList(props: DropdownListProps) {  const {    countryList,    isListOpen,    selectedCountryOption,    handleListDisplay,    handleSelectOption,  } = useDropdownListViewModel();  const { placeholder } = props;  const text = !selectedCountryOption ? placeholder : selectedCountryOption;  return (    &lt;DropdownListContainer onClick={handleListDisplay}&gt;      {text}      {isListOpen ? (        &lt;DropdownListOptionContainer&gt;          {countryList.map((el, idx) =&gt; (            &lt;DropdownListOption              key={el.getTitle()}              onClick={() =&gt; handleSelectOption(idx, \"countryList\")}            &gt;              {el.getTitle()}            &lt;/DropdownListOption&gt;          ))}        &lt;/DropdownListOptionContainer&gt;      ) : (        &lt;div /&gt;      )}    &lt;/DropdownListContainer&gt;  );}ViewëŠ” ì´ì „ê³¼ í° ì°¨ì´ëŠ” ì—†ì§€ë§Œ, ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ê³  ìˆ˜ì •í•˜ëŠ” ëª¨ë“  ë¡œì§ì„ ViewModelì„ í†µí•´ì„œ ë°›ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.ì²« ë¦¬íŒ©í† ë§ì„ ê±°ì¹œ í›„ ë°›ì€ í”¼ë“œë°±ì€ ë‘ ê°€ì§€ì˜€ìŠµë‹ˆë‹¤.ì²« ë²ˆì§¸ í”¼ë“œë°±ì€ Modelê³¼ ViewModelì´ íŠ¹ì • ë°ì´í„°(Country ì„ íƒì§€ ë°ì´í„°)ì— ë§ì¶°ì ¸ìˆë‹¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. ê·¸ë ‡ê²Œ ë˜ë©´ Modelê³¼ ViewModelì„ ì¬ì‚¬ìš©í•˜ê¸°ê°€ í˜ë“¤ê¸° ë•Œë¬¸ì— ë‹¤ì–‘í•œ ì„ íƒì§€ ë°ì´í„°ë¥¼ ì ìš©í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ìˆ˜ì •í•´ë‹¬ë¼ê³  í•˜ì…¨ìŠµë‹ˆë‹¤.ë‘ ë²ˆì§¸ í”¼ë“œë°±ì€ Modelì—ì„œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” í´ë˜ìŠ¤ê°€ ì˜ë¯¸ì—†ëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. ì„ íƒì§€ë¥¼ ì¶”ê°€í•œë‹¤ê±°ë‚˜ ì‚­ì œí•˜ëŠ” ë“± ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ëŠ” ë¡œì§ì´ í•„ìš”í•˜ë‹¤ë©´ ë¦¬ìŠ¤íŠ¸ë¥¼ ë‹¤ë£¨ëŠ” í´ë˜ìŠ¤ê°€ í•„ìš”í•˜ê² ì§€ë§Œ, í˜„ì¬ë¡œì„œëŠ” ê·¸ëŸ° ë¡œì§ì´ ì—†ìœ¼ë¯€ë¡œ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ê² ë‹¤ê³  í•˜ì…¨ìŠµë‹ˆë‹¤.2ì°¨ ë¦¬íŒ©í† ë§// Modelinterface DropdownListItem {  getTitle: () =&gt; string;  isSelected: () =&gt; boolean;  setSelected: (isSelected: boolean) =&gt; void;  isSelectable: () =&gt; boolean;}class DropdownListItemCreation implements DropdownListItem {  private readonly title: string;  private selected: boolean;  private readonly selectable: boolean = true;  constructor(title: string) {    this.title = title;    this.selected = false;    if (!title) this.selectable = false;  }  getTitle = () =&gt; this.title;  isSelected = () =&gt; this.selected;  setSelected = (selected: boolean) =&gt; {    this.selected = selected;  };  isSelectable = () =&gt; this.selectable;}const rawDataCountries = [\"Korea\", \"Japan\", \"Singapore\", \"Australia\"];const countryData = rawDataCountries.map((it) =&gt; new DropdownListItemCreation(it));export type { DropdownListItem };export { countryData };// ViewModelimport { useState } from \"react\";import { DropdownListItem } from \"@components/dropdown-list/model\";import { ViewModelInterface } from \"@components/dropdown-list\";function DropdownListViewModel(data: DropdownListItem[]): ViewModelInterface {  const [isListOpen, setIsListOpen] = useState&lt;boolean&gt;(false);  const [selectedOption, setSelectedOption] = useState&lt;string | undefined&gt;(undefined);  const dropdownList = data;  function handleListDisplay() {    setIsListOpen(!isListOpen);  }  function handleSelectOption(idx: number) {    setSelectedOption(dropdownList[idx].getTitle());  }  return { dropdownList, isListOpen, selectedOption, handleListDisplay, handleSelectOption };}export default DropdownListViewModel;export type { ViewModelInterface };í”¼ë“œë°±ì„ ë°›ì•˜ë˜ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ë‘ ë²ˆì§¸ ë¦¬íŒ©í† ë§ì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. ìš°ì„  í•´ë‹¹ Modelì´ Country ë°ì´í„°ë§Œ ë‹¤ë£¨ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ ì•Šë„ë¡ ì´ë¦„ì—ì„œ Countryë¼ëŠ” ë‹¨ì–´ë¥¼ ì œê±°í•˜ì˜€ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  Country ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ë§Œ ë¦¬í„´í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ì‚­ì œí•˜ê³ , í•„ìš”í•œ ë°ì´í„°ëŠ” ë³€ìˆ˜ì— ë°”ë¡œ ë‹´ì•„ map í•¨ìˆ˜ë¡œ ìš”ì†Œë“¤ì„ ì¸ìŠ¤í„´ìŠ¤í™” ì‹œì¼œ ë°°ì—´ì— ë‹´ì•„ export í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. ë§Œì•½ Country ë°ì´í„°ê°€ ì•„ë‹Œ Fruit ë°ì´í„°ê°€ ì‚¬ìš©ëœë‹¤ë©´ Fruit ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë‹´ì„ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œ í›„, ê°™ì€ í´ë˜ìŠ¤ë¡œ ì¸ìŠ¤í„´ìŠ¤í™” í•˜ì—¬ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆê² ì£ ?ViewModelì—ì„œë„ íŠ¹ì • ë°ì´í„°ë¥¼ ì§€ì¹­í•˜ëŠ” ë‹¨ì–´ê°€ ì—†ì–´ì ¸ í˜¼ë€ì„ ë°©ì§€í•˜ê³  ë°ì´í„°ì™€ ìƒê´€ì—†ì´ Viewì™€ Modelì„ ì´ì–´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤ëŠ” ê²ƒì´ ë” ì˜ ë³´ì—¬ì§€ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.// View// ... Styled components ë“± ë‹¤ë¥¸ importë“¤import { DropdownListItem } from \"@components/dropdown-list/model\";interface ViewModelInterface {  dropdownList: DropdownListItem[];  isListOpen: boolean;  selectedOption?: string;  handleListDisplay: () =&gt; void;  handleSelectOption: (idx: number) =&gt; void;}interface DropdownListProps {  placeholder: string;  viewModelProps: ViewModelInterface;}function DropdownList(props: DropdownListProps) {  const { placeholder, viewModelProps } = props;  const { dropdownList, isListOpen, selectedOption, handleListDisplay, handleSelectOption } = viewModelProps;  const text = !selectedOption ? placeholder : selectedOption;  return (    &lt;DropdownListContainer onClick={handleListDisplay}&gt;      {text}      {isListOpen ? (        &lt;DropdownListOptionContainer&gt;          {dropdownList.map((el, idx) =&gt; (            &lt;DropdownListOption key={el.getTitle()} onClick={() =&gt; handleSelectOption(idx)}&gt;              {el.getTitle()}            &lt;/DropdownListOption&gt;          ))}        &lt;/DropdownListOptionContainer&gt;      ) : (        &lt;div /&gt;      )}    &lt;/DropdownListContainer&gt;  );}export default DropdownList;export type { ViewModelInterface };View ë˜í•œ íŠ¹ì • ë°ì´í„°ì— ì–½í˜€ìˆëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ì•„ë‹ˆì–´ì„œ, ViewModelë¡œë¶€í„° ë°›ì•„ì˜¨ ë°ì´í„°ì˜ ì´ë¦„ì„ ë°”ê¿”ì¤€ ê²ƒ ë§Œìœ¼ë¡œë„ ì—¬ëŸ¬ê³³ì—ì„œ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©í•˜ê¸° í¸í•´ì¡ŒìŠµë‹ˆë‹¤.ê·¸ë¦¬ê³ , Viewì™€ ViewModelì„ ì—°ê²°í•  ë•ŒëŠ” View ë‚´ë¶€ì—ì„œ ViewModelì„ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒ ë³´ë‹¤ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê³³ì—ì„œ propsë¥¼ í†µí•´ ViewModelì„ ë„˜ê²¨ì£¼ëŠ” ê²ƒì´ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê¸° ìš©ì´í•˜ë‹¤ê³  ì•Œë ¤ì£¼ì…”ì„œ ì—°ê²°ë°©ë²•ì„ ë°”ê¿”ì£¼ì—ˆìŠµë‹ˆë‹¤.&lt;DropdownList placeholder={\"ì„ íƒí•´ì£¼ì„¸ìš”\"} viewModelProps={DropdownListViewModel(countryData)} /&gt;ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•  ë•Œ ì´ë ‡ê²Œ ViewModelì— ë°ì´í„°ë¥¼ ë‹´ì€ í›„ propsë¡œ ì „ë‹¬í•´ì£¼ê²Œ ë©ë‹ˆë‹¤.3ì°¨ ë¦¬íŒ©í† ë§// ViewModelimport { useState } from \"react\";import { DropdownListItem } from \"@components/dropdown-list/model\";import { DropdownViewModelInterface } from \"@components/dropdown-list\";function DropdownListViewModel(data: DropdownListItem[]): DropdownViewModelInterface {  // selectedOption ìƒíƒœê°’ì˜ ê²½ìš° ë‹¨ìˆœíˆ ì–´ë–¤ ì„ íƒì§€ê°€ ê³¨ë¼ì¡ŒëŠ”ì§€ viewì—ì„œ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ê²ƒë¿ë§Œ ì•„ë‹ˆë¼, formì„ ì œì¶œí•œë‹¤ë˜ì§€ í•˜ëŠ” ê²½ìš°ì— ê·¸ ê°’ì„ ë„˜ê²¨ì£¼ê¸° ìœ„í•´ ì‚¬ìš©ë  ê°€ëŠ¥ì„±ì´ ìˆë‹¤.  // ê·¸ë ‡ê²Œ ë„˜ê²¨ì§„ ê°’ì€ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì˜ ë·°ë¥¼ ì¡°ì •í•˜ëŠ” ê³¼ì •ì—ì„œ ì“°ì¼ ìˆ˜ ìˆë‹¤.  // ë”°ë¼ì„œ ì´ ìƒíƒœê°’ì€ íŠ¹ì • ë·°ì—ì„œ ê´€ë¦¬ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë·°ëª¨ë¸ì—ì„œ ê´€ë¦¬í•œë‹¤.  const [selectedOption, setSelectedOption] = (useState &lt; string) | (undefined &gt; undefined);  const dropdownList = data;  function handleSelectOption(idx: number) {    setSelectedOption(dropdownList[idx].getTitle());    dropdownList.map((it: DropdownListItem, index: number) =&gt; it.setSelected(idx === index));  }  return { dropdownList, selectedOption, handleSelectOption };}export default DropdownListViewModel;// View// ... Styled components ë“± ë‹¤ë¥¸ importë“¤import { DropdownListItem } from \"@components/dropdown-list/model\";interface DropdownViewModelInterface {  dropdownList: DropdownListItem[];  selectedOption?: string;  handleSelectOption: (idx: number) =&gt; void;}interface DropdownListProps {  placeholder: string;  viewModelProps: DropdownViewModelInterface;}function DropdownList(props: DropdownListProps) {  const [isListOpen, setIsListOpen] = useState&lt;boolean&gt;(false);  const { placeholder, styleProps, viewModelProps } = props;  const { dropdownList, selectedOption, handleSelectOption } = viewModelProps;  const text = !selectedOption ? placeholder : selectedOption;  return (    &lt;DropdownListContainer onClick={() =&gt; setIsListOpen(!isListOpen)}&gt;      {text}      {isListOpen ? (        &lt;DropdownListOptionContainer&gt;          {dropdownList.map((el, idx) =&gt; (            &lt;DropdownListOption key={el.getTitle()} onClick={() =&gt; handleSelectOption(idx)}&gt;              {el.getTitle()}            &lt;/DropdownListOption&gt;          ))}        &lt;/DropdownListOptionContainer&gt;      ) : (        &lt;div /&gt;      )}    &lt;/DropdownListContainer&gt;  );}export default DropdownList;export type { DropdownViewModelInterface };ViewModel ì•ˆì˜ ì½”ë“œë¥¼ ë³´ë‹¤ë³´ë‹ˆ UI ë¡œì§ì´ í¬í•¨ë˜ì–´ìˆëŠ” ê²ƒì´ ë³´ì˜€ìŠµë‹ˆë‹¤. ë¦¬ìŠ¤íŠ¸ê°€ ì—´ë ¸ëŠ”ì§€ í™•ì¸í•˜ëŠ” ë¡œì§ì€ Viewê°€ ê´€ë¦¬í•´ì•¼ í•  ì˜ì—­ì´ë¼ê³  ìƒê°ë˜ì–´ ViewModelì— ìˆë˜ ì½”ë“œë¥¼ Viewë¡œ ì˜®ê²¨ì£¼ì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ UI ë¡œì§ì€ ì˜¤ë¡¯ì´ Viewì—ì„œ ê´€ë¦¬í•˜ê²Œ ë˜ì—ˆê³ , ë¶ˆí•„ìš”í•˜ê²Œ ViewModelì„ ê±°ì³ í™”ë©´ì„ ë°”ê¾¸ëŠ” ì½”ë“œê°€ ì‚­ì œë˜ì–´ ê°„ê²°í•´ì¡ŒìŠµë‹ˆë‹¤.ë§ˆì¹˜ë©°ëª‡ ë‹¨ê³„ë¥¼ ê±°ì³ ì™„ë²½í•˜ì§€ëŠ” ì•Šì§€ë§Œ Model-View-ViewModelì˜ ì—­í• ì´ êµ¬ë¶„ëœ ì½”ë“œê°€ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤. MVVM íŒ¨í„´ì„ ì ìš©í•˜ë©´ì„œ ê°€ì¥ ì–´ë ¤ì› ë˜ ì ì€ ViewModelì˜ ì—­í• ì„ ì°¾ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. ì´ì „ì—ëŠ” ë°ì´í„°ë¥¼ UIì— ë°”ë¡œ ì ìš©í–ˆê¸° ë•Œë¬¸ì— ViewModelì´ë¼ëŠ” ê²ƒì„ í•œë²ˆë„ ì‚¬ìš©í•´ë³´ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ë ‡ê²Œ ì½”ë“œë¥¼ ë‚˜ëˆ„ê³  ë³´ë‹ˆ ë””ìì¸ì´ ë‹¤ë¥¸ ìƒˆë¡œìš´ ë“œë¡­ë‹¤ìš´ ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ê²Œ ë˜ë”ë¼ë„ ë¯¸ë¦¬ ë§Œë“¤ì–´ë†“ì€ ViewModelê³¼ Modelì„ ì‰½ê²Œ ì¬ì‚¬ìš©í•˜ë©´ ë˜ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì¤‘ë³µë˜ëŠ” ì½”ë“œê°€ ì¤„ì–´ë“¤ë©´ì„œ ìœ ì§€ë³´ìˆ˜ë„ í›¨ì”¬ ì‰¬ì›Œì§ˆ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì €ëŠ” ì´ ê²½í—˜ì„ ì‹œì‘ìœ¼ë¡œ, ë³µì¡í•œ ë¡œì§ì„ ë” ì‰½ê²Œ ë‹¤ë£°ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ê³„ì† ê³ ë¯¼í•˜ê³  ê³µë¶€í•´ë³´ì•„ì•¼ê² ìŠµë‹ˆë‹¤. ğŸ˜Š"
  },
  
  {
    "title": "FastAPIì™€ SQLAlchemy í™˜ê²½ì—ì„œ Database Test",
    "url": "/posts/fast-api-db-test/",
    "categories": "python, backend",
    "tags": "fastapi, sqlalchemy, unittest",
    "date": "2022-06-26 15:32:00 +0900",
    





    
    "snippet": "FIRST ì›ì¹™ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë° ìˆì–´ ì—¬ëŸ¬ ê°€ì§€ ê°€ì´ë“œê°€ ìˆì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ ì ìš©í•˜ê³  ìˆëŠ” FIRST ì›ì¹™ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.  Fast  Independent  Repeatable  Self-Validating  Timelyí•˜ì§€ë§Œ 22ë…„ 6ì›” ê¸°ì¤€ FastAPIì™€ SQLAlchemyì—ì„œ ì œê³µí•˜ëŠ” ê³µì‹ë¬¸ì„œìƒì˜ íŠœí† ë¦¬ì–¼ì„ ë”°ë¼ê°€ë©´ 2ë²ˆì§¸ í•­ëª©ì¸ ...",
    "content": "FIRST ì›ì¹™ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë° ìˆì–´ ì—¬ëŸ¬ ê°€ì§€ ê°€ì´ë“œê°€ ìˆì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ ì ìš©í•˜ê³  ìˆëŠ” FIRST ì›ì¹™ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.  Fast  Independent  Repeatable  Self-Validating  Timelyí•˜ì§€ë§Œ 22ë…„ 6ì›” ê¸°ì¤€ FastAPIì™€ SQLAlchemyì—ì„œ ì œê³µí•˜ëŠ” ê³µì‹ë¬¸ì„œìƒì˜ íŠœí† ë¦¬ì–¼ì„ ë”°ë¼ê°€ë©´ 2ë²ˆì§¸ í•­ëª©ì¸ Independentë¥¼ ë§Œì¡±í•˜ì§€ ëª»í•˜ëŠ” í˜„ìƒì´ ë°œìƒí•©ë‹ˆë‹¤. ì´ëŠ” ë§¤ìš° ì•ˆíƒ€ê¹Œìš´ ìƒí™©ì´ë©°, ë§ì€ ê¸°ìˆ  ë¸”ë¡œê·¸ë¥¼ ë³´ì•„ë„ ìœ„ì™€ ê°™ì€ ìƒí™©ìœ¼ë¡œ ê³ ë¯¼í•˜ëŠ” ê°œë°œìë“¤ì„ ë§Œë‚˜ë³¼ ìˆ˜ ìˆì£ .ì´ í¬ìŠ¤íŒ…ì€ ì´ëŸ° ë¬¸ì œì— ëŒ€í•´ ë‹¤ë¥¸ Unit-Test libì—ì„œì™€ ê°™ì´ ë…ë¦½ì„±ì„ ë³´ì¥í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ í™˜ê²½ì„ êµ¬ì„±í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì¡ì•„ë³´ì•˜ìŠµë‹ˆë‹¤.Database EngineFastAPIì—ì„œ ì œê³µí•˜ëŠ” ê³µì‹ ë¬¸ì„œëŒ€ë¡œ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ Databaseë¥¼ ì´ìš©í•´ì•¼ í•  ë•Œ sqlite:///:memory:ì™€ ê°™ì´ SQLiteë¥¼ ì´ìš©í•˜ë¼ê³  ê¶Œê³ í•˜ê³  ìˆìŠµë‹ˆë‹¤.ì´ì™€ ê°™ì€ ë°©ì‹ì€ ëŒ€ë¶€ë¶„ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•Šì§€ë§Œ, ì‹¤ì œ ì„œë¹„ìŠ¤ê°€ sqliteë¡œ êµ¬ì„±ë˜ì–´ìˆì§€ ì•Šë‹¤ë©´ ëª‡ëª‡ field ë“±ì—ì„œëŠ” ì‹¤ì œë¡œ êµ¬ì„±ëœ ìŠ¤í‚¤ë§ˆì™€ ë‹¤ë¥¸ ë¬¸ì œ ë•Œë¬¸ì— ì™„ë²½í•œ í…ŒìŠ¤íŠ¸ë¥¼ ë³´ì¥í•  ìˆ˜ ì—†ë‹¤ëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.Testê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ë˜ê³  ë‚œ í›„ì˜ ì½”ë“œëŠ” ì‹¤ì œìƒí™©ì—ì„œ ì•ˆì •ì ì¸ ë™ì‘ì„ ë³´ì¥í•´ì•¼ í•˜ëŠ”ë° MySQLì„ ì‚¬ìš©í•˜ëŠ” ìš°ë¦¬ ì„œë¹„ìŠ¤ì—ì„œ SQLiteë¥¼ ì´ìš©í•œ Database í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•  ìˆ˜ëŠ” ì—†ì—ˆìŠµë‹ˆë‹¤.ë˜í•œ ì‹¤ì œ í™˜ê²½ê³¼ ë™ì¼í•œ í™˜ê²½ì„ êµ¬ì„±í•˜ê¸° ìœ„í•œë‹¤ëŠ” ëª…ë¶„ìœ¼ë¡œ ì•„ë¬´ë¦¬ ê°œë°œ ì„œë²„ë¼ê³  í•˜ë”ë¼ë„ Testë¥¼ ê·¸ê³³ì—ì„œ ì‹¤í–‰í•  ìˆ˜ëŠ” ì—†ë‹¤ëŠ” íŒë‹¨ê³¼ Testì˜ Performanceë¥¼ ìœ„í•´ ë¡œì»¬ í™˜ê²½ì— MySQL ì„œë²„ë¥¼ ìƒì„±í•˜ëŠ” ìª½ìœ¼ë¡œ ë°©í–¥ì„ ì¡ê³  Dockerë¥¼ ì´ìš©í•´ MySQL ì„œë²„ë¥¼ ë„ì›Œë³´ì•˜ìŠµë‹ˆë‹¤.docker run --platform linux/amd64 -p 3306:3306 --name test_db -e MYSQL_ROOT_PASSWORD=password -e MYSQL_DATABASE=test_db -e MYSQL_PASSWORD=password --restart=unless-stopped -d mysqlTest í™˜ê²½ë³€ìˆ˜ ì„¤ì •Testê°€ ë™ì‘í•˜ëŠ” í™˜ê²½ì´ë¼ê³  í•˜ë”ë¼ë„ ê¸°ë³¸ì ìœ¼ë¡œ ì‹¤ì œ í™˜ê²½ê³¼ ê±°ì˜ ë™ì¼í•œ í™˜ê²½ì—ì„œ ì‘ë™ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.í•˜ì§€ë§Œ Test í™˜ê²½ì—ì„œë§Œ ì ìš©ë˜ì–´ì•¼ í•˜ëŠ” í™˜ê²½ë³€ìˆ˜ì— ëŒ€í•œ Mockingì´ í•„ìš”í•œë° pytestì—ì„œ ì œê³µí•´ì£¼ëŠ” pytest.inië¥¼ í†µí•´ ë‹¤ìŒê³¼ ê°™ì´ Databaseì˜ í™˜ê²½ë³€ìˆ˜ ìœ„ì£¼ë¡œ ì¬êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ìœ„ Sectionì—ì„œë„ ì„¤ëª…í–ˆë“¯ì´ ì‹¤ì œ Databaseì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ìˆ˜ëŠ” ì—†ìœ¼ë‹ˆê¹Œ ë§ì´ì£ .[pytest]env =    APP_ENV=test    DATABASE_HOST=localhost    DATABASE_USER=root    DATABASE_PASSWORD=password    DATABASE_NAME=test_dbDatabase Engine ìƒì„±ì•„ì´ë©”ë””ì‹  ì—ì„œëŠ” Database ì ‘ê·¼ì— ëŒ€í•´ì„œ SQLAlchemyë¼ëŠ” ê°ì²´ í˜•ì‹ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. SQLAlchemyëŠ” Python í™˜ê²½ì—ì„œ ORMì„ ì œê³µí•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, ìƒë‹¹íˆ ë§ì€ Python ê¸°ë°˜ì˜ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆì„ ì •ë„ë¡œ ë²”ìš©ì„±ì´ ë†’ë‹¤ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. FastAPIì˜ ê³µì‹ ë¬¸ì„œì—ì„œë„ SQLAlchemyë¥¼ ë‹¤ë£¨ê³  ìˆê¸°ë„ í•˜ì£ .class Settings(BaseSettings):    ...    @property    def database_url(self):        return f'mysql+pymysql://{self.DATABASE_USER}:{self.DATABASE_PASSWORD}@' \\               f'{self.DATABASE_HOST}:{self.DATABASE_PORT}/{self.DATABASE_NAME}?charset=utf8mb4'...class SQLAlchemy:    @classmethod    def create_engine(cls):        setting_dict = dict(            DATABASE_URL=settings.database_url,            DATABASE_POOL_RECYCLE=settings.DATABASE_POOL_RECYCLE,            DATABASE_ECHO=settings.DATABASE_ECHO,        )        return SQLAlchemy(**setting_dict)    ......database = SQLAlchemy.create_engine()Settings ê°ì²´ë¥¼ ë³´ë©´ database_urlì„ ì¡°í•©, ë¦¬í„´ í•´ì£¼ëŠ” propertyì—ì„œ DATABASE_HOST, DATABASE_USERâ€¦ ë“±ì˜ í™˜ê²½ë³€ìˆ˜ê°€ ìˆëŠ”ë°, ë§Œì•½ êµ¬ë™ë˜ëŠ” í™˜ê²½ì´ Test í™˜ê²½ì´ë¼ë©´ ì•ì„œ pytest.iniì—ì„œ ì„¤ì •í•´ì¤€ í™˜ê²½ë³€ìˆ˜ê°€ ì ìš©ë˜ì–´ local.databaseë¥¼ ë°”ë¼ë³´ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.conftest.pypytestì—ì„œëŠ” í…ŒìŠ¤íŠ¸ í™˜ê²½ì— í•„ìš”í•œ fixture, plugin, module ë“±ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ conftest.pyë¼ëŠ” íŒŒì¼ì„ ì‚¬ìš©í•  ê²ƒì„ ê¶Œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¨ìœ„í…ŒìŠ¤íŠ¸ê°€ ë™ì‘í•  ë•Œ í•„ìš”í•œ givenì„ ë¯¸ë¦¬ ì •ì˜ í•´ë†“ì€ íŒŒì¼ë¡œ, ì¼ì¢…ì˜ setUp í•¨ìˆ˜ì™€ ë¹„ìŠ·í•˜ì§€ë§Œ ë™ì¼í•˜ì§€ëŠ” ì•Šì£ .ë˜í•œ ëª¨ë“  ë‹¨ìœ„í…ŒìŠ¤íŠ¸ì—ì„œ ë‹¨ í•˜ë‚˜ì˜ sessionì„ í˜¸ì¶œí•´ì•¼ í…ŒìŠ¤íŠ¸ê°€ ì¢…ë£Œë˜ì—ˆì„ ë•Œ í›„ì† ì‘ì—…ì„ ì¼ê´„ë˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ì ê³¼ í•œ ë²ˆì˜ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‚´ì—ì„œ ëª‡ ë‹¨ê³„ì— ê±¸ì³ fixtureë¥¼ í˜¸ì¶œí•´ë„ ë©±ë“±ì„±ì„ ë³´ì¥í•œë‹¤ëŠ” íŠ¹ì§•ì€ conftestë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ ì´ê¸°ë„ í•˜ì£ .ì´ì œ conftestì— Test ìš© Database ì„¸ì…˜ì„ ê´€ë¦¬í•˜ë„ë¡ í•´ë³´ê² ìŠµë‹ˆë‹¤.from app.app_core.databases.conn import database@fixture(scope='session', autouse=True)def db():    from sqlalchemy_utils import create_database, database_exists, drop_database    engine = database.engine    _db = {        'engine': engine,        'session': sessionmaker(autocommit=False, autoflush=False, bind=engine),    }    if database_exists(engine.url):        drop_database(engine.url)    create_database(engine.url)    try:        from alembic.config import Config as AlembicConfig        from alembic.command import upgrade as alembic_upgrade, downgrade as alembic_downgrade        from app.app_core.settings import settings        alembic_config = AlembicConfig()        alembic_config.set_main_option('sqlalchemy.url', settings.database_url)        alembic_config.set_main_option('script_location', 'revision')        alembic_upgrade(alembic_config, 'head')        yield _db    finally:        engine.dispose()fixtureì— ì œê³µë˜ëŠ” ë§¤ê°œë³€ìˆ˜ ì¤‘ scope='session'ì„ í†µí•´ í•´ë‹¹ fixtureê°€ í…ŒìŠ¤íŠ¸ê°€ ìœ ì§€ë˜ëŠ” ë™ì•ˆ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•˜ë„ë¡ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ëŠ” í…ŒìŠ¤íŠ¸ ê±´ë‹¹ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ê±´ í…ŒìŠ¤íŠ¸ì˜ ì„±ëŠ¥ ì €í•˜ì™€ë„ ë°€ì ‘í•œ ì—°ê´€ì´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë˜í•œ autouse=True ì˜µì…˜ì„ ì£¼ì–´ ëª…ì‹œì ìœ¼ë¡œ dbë¼ëŠ” fixtureë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì•„ë„ ë°ì´í„°ë² ì´ìŠ¤ê°€ êµ¬ì„±ë  ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.ì´ì œ db ì¸ìŠ¤í„´ìŠ¤ê°€ í•„ìš”í•œ ì–´ëŠ ê³³ì—ì„œë“  def test_some(db):ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ databaseì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.í•˜ì§€ë§Œ ëŒ€ë¶€ë¶„ì˜ ì½”ë“œì—ì„œëŠ” database ê°ì²´ì— ì§ì ‘ ì ‘ê·¼ í•˜ëŠ” ê²½ìš°ë³´ë‹¨ í•˜ë‚˜ì˜ sessionì— ì ‘ê·¼í•˜ëŠ” ê²Œ ì¼ë°˜ì ì…ë‹ˆë‹¤. ë”°ë¼ì„œ session ê°ì²´ ì—­ì‹œ fixtureë¡œ ê´€ë¦¬í•´ì•¼ í•  í•„ìš”ì„±ì„ ëŠë‚ë‹ˆë‹¤.@fixturedef engine(db):    engine = db['engine']    connection = engine.connect()    transaction = connection.begin()    yield engine    transaction.rollback()@fixturedef session(db) -&gt; Session:    session = db['session']()    session.begin_nested()    yield session    session.rollback()    session.close()í˜„ì¬ê¹Œì§€ ì•„ì´ë©”ë””ì‹ ì˜ FastAPI í”„ë¡œì íŠ¸ëŠ” engineì„ ì§ì ‘ ì œì–´í•˜ì§€ëŠ” ì•Šì§€ë§Œ, ì¶”í›„ í•„ìš”í• ì§€ë„ ëª¨ë¥¸ë‹¤ëŠ” ìƒê°ì— sessionì„ ë§Œë“¤ë©´ì„œ í•¨ê»˜ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤.ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë‚´ì—ì„œ ë°˜ë“œì‹œ conftestì— ì •ì˜ëœ session fixtureë¥¼ ì‚¬ìš©í•  í•„ìš”ëŠ” ì—†ì§€ë§Œ, ì•ì„œ ì„¤ëª…í•œ ê²ƒê³¼ ê°™ì´ í…ŒìŠ¤íŠ¸ê°€ ì¢…ë£Œëœ í›„ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šê¸° ìœ„í•´ì„œ ì²˜ë¦¬í•˜ëŠ” session.rollback() ë¶€ë¶„ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ê¸° ìœ„í•´ì„  session fixtureë¥¼ ì‚¬ìš©í•  ê²ƒì„ ê¶Œí•©ë‹ˆë‹¤.# í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±# session.commit(), session.close() ì²˜ë¦¬ê°€ ì™„ë£Œë˜ê¸° ì „ì— ë‹¤ë¥¸ sessionì—ì„œ ì ‘ê·¼ ì‹œ# ê°’ì´ ë°˜ì˜ë˜ì–´ ìˆì§€ ì•Šì€ ë¬¸ì œê°€ ìˆìŒ# ë˜í•œ fixtureì—ì„œ ì‚¬ìš©í•œ rollback() ì²˜ë¦¬ê°€ ë™ì‘í•˜ì§€ ì•ŠìŒdef test_some():session = next(database.session())...# í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±# flush() ì²˜ë¦¬ë§Œ ë˜ì–´ìˆì–´ë„ ë°ì´í„°ë² ì´ìŠ¤ì— ê°’ì´ ë°˜ì˜ëœ ê²ƒì²˜ëŸ¼ ë³´ì„# ê°€ì¥ ì¤‘ìš”í•œ rollback() ì²˜ë¦¬ í•œ ë²ˆìœ¼ë¡œ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ ì½”ë“œì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŒdef test_some(session):dependency_overridesFastAPIì—ì„œëŠ” router í˜¸ì¶œ ì‹œ Dependsë¥¼ ì´ìš©í•´ ì—¬ëŸ¬ ê³³ì—ì„œ ê°™ì€ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë”ë¼ë„ ë‹¨ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” ë°©ì‹ì„ ì œê³µí•©ë‹ˆë‹¤. ì¼ì¢…ì˜ Singleton íŒ¨í„´ê³¼ë„ ê°™ì€ ë°©ì‹ì´ì£ . ê·¸ë¦¬ê³  í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì´ ì˜ì¡´ì„±ì„ Mocking í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ dependency_overridesë¼ëŠ” ë°©ì‹ìœ¼ë¡œ ì œê³µí•´ì£¼ê³  ìˆìŠµë‹ˆë‹¤.dependency_overridesë¥¼ ë°˜ë“œì‹œ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ ëŠ” ì‹¤ì œ ë™ì‘ í•˜ëŠ” ì½”ë“œì¸ routerì—ì„œëŠ” conftestì˜ fixtureë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.ì¼ë°˜ì ìœ¼ë¡œ router ì•ˆì—ì„œ ì‚¬ìš©ë˜ëŠ” database.sessionì€ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ë©ë‹ˆë‹¤.@router.post(    '/id',    summary='ì•„ì´ë”” ì°¾ê¸°',    ...)async def post_id(        session: Session = Depends(database.session),):    ...ë§Œì•½ dependency_overridesë¥¼ ì •ì˜í•´ ë†“ì§€ ì•Šì€ ìƒí™©ì´ë¼ë©´ routerë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ì˜ sessionì´ ìƒì„±ë  ê²ƒì´ë©°, ë‹¤ìŒê³¼ ê°™ì€ í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œ ê·¸ ë™ì‘ì„ ì‹ ë¢°ì„±ì„ ë³´ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.def test_some(client, session, admin_user):    customized_package = CustomizePackagePrice(...)    session.add(customized_package)    url = PATH_PAYMENTS_V1_0 + f'/customize_price_package?packageId={customized_package.id}'    user = gen_admin_user    client.force_authenticate(user)    res = client.get(url)    ...@router.get(    '/customize_price_package',    ...)async def get_customize_package_price(        query: CustomizePackagePriceQuery = Depends(),        session: Session = Depends(database.session),):    ...    package_id = query.package_id    packages = list_customize_package_price(session, package_id, user)    # dependency_overridesì„¤ì •ì´ ë˜ì–´ìˆì§€ ì•Šë‹¤ë©´ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ì˜ sessionìœ¼ë¡œ ì¸í•´ not found ë°œìƒ    return paginate(packages)ë”°ë¼ì„œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œ ë°˜ë“œì‹œ dependency_overridesë¥¼ êµ¬í˜„í•´ ì£¼ì–´ì•¼ ë™ì‘ì˜ ì‹ ë¢°ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆìœ¼ë©° FastAPIì—ì„œ ì œê³µí•˜ëŠ” ê³µì‹ ë¬¸ì„œìƒ êµ¬í˜„ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.def override_get_db():    try:        db = TestingSessionLocal()        yield db    finally:        db.close()app.dependency_overrides[get_db] = override_get_dbí•˜ì§€ë§Œ ì´ ë°©ì‹ëŒ€ë¡œ êµ¬í˜„í•˜ê²Œ ë˜ë©´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë‚´ì—ì„œ ì‚¬ìš©í•˜ëŠ” sessionê³¼ routerì—ì„œ ì‚¬ìš©ë˜ëŠ” sessionì´ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ìœ„ì—ì„œ ì§€ì í•œ ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ ì ‘ê·¼ì´ ìœ„ë°° ë˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ë©°, ë¬´ì—‡ë³´ë‹¤ í•œ ë²ˆì˜ í…ŒìŠ¤íŠ¸ê°€ ëë‚œ í›„ ê·¸ì™€ ê´€ë ¨ëœ ë°ì´í„°ì˜ rollback ì²˜ë¦¬ê°€ ìˆ˜ì›”í•˜ì§€ ì•Šë‹¤ëŠ” ë¬¸ì œê°€ ìˆì£ .ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„  ì´ì „ì— êµ¬ì„±í•œ fixtureë¥¼ dependency injection í•´ì£¼ì–´ì•¼ í•˜ëŠ”ë° ì´ëŸ° ë°©ì‹ì„ êµ¬ìƒí•´ ë³´ì•˜ìŠµë‹ˆë‹¤.app.dependency_overrides[engine.session] = sessionìœ„ ì½”ë“œê°€ ì˜ ë™ì‘í•œë‹¤ë©´ í›Œë¥­í•˜ê² ì§€ë§Œ, ì•„ì£¼ ì»¤ë‹¤ë€ ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ë°”ë¡œ sessionì´ë¼ëŠ” fixtureëŠ” dbë¼ëŠ” ë‹¤ë¥¸ fixtureë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ê³  ìˆë‹¤ëŠ” ì ê³¼ fixtureëŠ” ì¼ì¢…ì˜ @propertyë¼ëŠ” ì ì´ì£ . ì•„ë§ˆë„ ë‹¹ì‹ ì´ ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ë¥¼ ë§Œë‚˜ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.'&lt;sqlalchemy.orm.session.Session object at 0x1145520d0&gt; is not a callable object'ë‚œê´€ì— ë¶€ë”ªíŒ ìƒí™©ì´ì—ˆì§€ë§Œ, ë‹¤í–‰íˆë„ lambda í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ ìƒê°ë³´ë‹¤ëŠ” ê°„ë‹¨í•˜ê²Œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë˜í•œ ì•„ì´ë©”ë””ì‹ ì—ì„œ í˜„ì¬ê¹Œì§€ ê°œë°œëœ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” Dependsë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ì„  TestClientë¥¼ ì´ìš©í•´ routerë¥¼ í˜¸ì¶œí•˜ëŠ” ë•Œ ì™¸ì—ëŠ” ì—†ìœ¼ë¯€ë¡œ dependency_overridesë¥¼ TestClientë¥¼ í˜¸ì¶œí•˜ëŠ” fixtureì—ì„œ ì„¤ì •í•´ì£¼ë„ë¡ êµ¬ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤.@fixturedef client(session):    # lambdaì‹ì„ ì´ìš©í•´ function í˜•íƒœë¡œ inject    app.dependency_overrides[engine.session] = lambda: session    from tests.test_routes import get_client    return get_client()ìœ„ì™€ ê°™ì€ êµ¬ì„±ìœ¼ë¡œ test ì½”ë“œì™€ routerì—ì„œ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ sessionì„ ì‚¬ìš©í•˜ê²Œ ë˜ì–´ router í…ŒìŠ¤íŠ¸ì—ì„œ ì™„ë²½í•œ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.í™˜ê²½ êµ¬ì„±ì˜ ëˆ„ë½ ë°©ì§€ë§Œì•½ ë‹¹ì‹ ì´ êµ¬í˜„í•˜ê³  ìˆëŠ” í”„ë¡œì íŠ¸ì˜ ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ì ‘ê·¼ì œì–´ê°€ strict í•˜ì§€ ì•Šì€ ìƒí™©ì´ê³ , í”„ë¡œì íŠ¸ë¥¼ ë‹¤ë¥¸ í™˜ê²½ì—ì„œ clone í•˜ì—¬ ì‘ì—…ì„ í•˜ë ¤ë˜ ì¤‘ pytest.inië¥¼ êµ¬ì„±í•˜ëŠ” ê±¸ ìŠì€ ìƒíƒœë¼ë©´ pytest ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ëŠ” ìˆœê°„if database_exists(engine.url):    drop_database(engine.url)ì„¤ì •ì— ë”°ë¼ ì‹¤ì œ ë°ì´í„° ë² ì´ìŠ¤ì— ëª¨ë“  í…Œì´ë¸”ì´ ì‚­ì œë˜ëŠ” í˜„ìƒì´ ë°œìƒí•  ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ì‹¤ì œ ì„œë¹„ìŠ¤ê°€ ì¤‘ë‹¨ë ì§€ë„ ëª¨ë¥´ëŠ” ë§¤ìš° ìœ„í—˜í•œ ìƒí™©ì„ ë‚´í¬í•˜ê³  ìˆì£ .ì œê°€ ìƒê°í•˜ëŠ” ì´ìƒì ì¸ ì ‘ê·¼ì œì–´ë¼ë©´ database ì¸ìŠ¤í„´ìŠ¤ëŠ” VPC ì•ˆì—ì„œ private ê³µê°„ì— ìœ„ì¹˜í•´ì•¼ í•˜ê³ , í•´ë‹¹ í”„ë¡œì íŠ¸ë¥¼ ê°œë°œí•˜ê³  ìˆëŠ” Engineerë¼ê³  í•˜ë”ë¼ë„ ì§ì ‘ì ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.í•˜ì§€ë§Œ ì—¬ëŸ¬ ê°€ì§€ ìƒí™©ìœ¼ë¡œ ìœ„ì™€ ê°™ì€ í™˜ê²½ êµ¬ì„±ì´ ì–´ë ¤ìš´ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì€ ê²€ì¦ ì‹ì„ conftest.py ìµœìƒë‹¨ì— ì¶”ê°€ í•¨ìœ¼ë¡œì¨, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚­ì œí•˜ëŠ” ì‹¤ìˆ˜ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆì„ê²ƒì…ë‹ˆë‹¤.assert settings.APP_ENV == 'test', 'test í™˜ê²½ì—ì„œë§Œ test ê°€ëŠ¥, `pytest.ini` í™•ì¸ í•„!'ë§ˆì¹˜ë©°ë‹¨ìœ„í…ŒìŠ¤íŠ¸ëŠ” í”„ë¡œì íŠ¸ë¥¼ ê°œë°œí•´ ë‚˜ê°ì— ìˆì–´ ì•„ì£¼ ê¸°ë³¸ì ì´ì§€ë§Œ ë§¤ìš° ì¤‘ìš”í•œ ì ˆì°¨ì´ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ í¬ìŠ¤íŒ… ë³´ë‹¨ ì¡°ê¸ˆ ë” ì‹¬ë„ ìˆê²Œ ë‹¤ë£¨ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤. ì•„ë§ˆë„ ë‹¤ë¥¸ ì£¼ì œë¡œ ë˜ë‹¤ì‹œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì— ëŒ€í•´ì„œ í¬ìŠ¤íŒ…ì„ ì‘ì„±í•  ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ê¸°ë„ í•˜ë„¤ìš”.ë˜ ë‹¤ë¥¸ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì£¼ì œë¡œ ë§Œë‚˜ ëµ™ê¸°ë¥¼ í¬ë§í•©ë‹ˆë‹¤ :)"
  },
  
  {
    "title": "Python ì—´ê±°í˜•ê³¼ SQLAlchemy",
    "url": "/posts/annotated-enum/",
    "categories": "python, structure",
    "tags": "enum, sqlalchemy",
    "date": "2022-05-15 09:00:00 +0900",
    





    
    "snippet": "Pythonì˜ Enum Typeê¸°ë³¸ì ìœ¼ë¡œ Pythonì˜ ì—´ê±°í˜•ì€ ì—¬ëŸ¬ ì´ë¦„ì„ ê°™ì€ ê°’ì— ëŒ€í•´ ë³„ì¹­ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.ì˜ˆë¥¼ ë“¤ë©´ ì—´ê±°í˜•ì˜ ë©¤ë²„ì— ë™ì¼í•œ ê°’ì„ ê°€ì§„ Aì™€ Bê°€ ì •ì˜ë˜ì–´ ìˆë‹¤ë©´ BëŠ” Aì˜ ë³„ì¹­ì…ë‹ˆë‹¤.class Shape(Enum):    SQUARE = 2    DIAMOND = 1    CIRCLE = 3    ALIAS_FOR_SQUARE ...",
    "content": "Pythonì˜ Enum Typeê¸°ë³¸ì ìœ¼ë¡œ Pythonì˜ ì—´ê±°í˜•ì€ ì—¬ëŸ¬ ì´ë¦„ì„ ê°™ì€ ê°’ì— ëŒ€í•´ ë³„ì¹­ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.ì˜ˆë¥¼ ë“¤ë©´ ì—´ê±°í˜•ì˜ ë©¤ë²„ì— ë™ì¼í•œ ê°’ì„ ê°€ì§„ Aì™€ Bê°€ ì •ì˜ë˜ì–´ ìˆë‹¤ë©´ BëŠ” Aì˜ ë³„ì¹­ì…ë‹ˆë‹¤.class Shape(Enum):    SQUARE = 2    DIAMOND = 1    CIRCLE = 3    ALIAS_FOR_SQUARE = 2ìœ„ Shapeë¥¼ ì˜ˆë¡œ ë“¤ì–´ë³´ë©´ ALIAS_FOR_SQUAREëŠ” SQUAREì˜ ë³„ì¹­ìœ¼ë¡œ SQUARE, ALIAS_FOR_SQUARE ì¤‘ ì–´ëŠ ê²ƒì„ ì¡°íšŒí•´ë„ 2(SQUARE)ë¥¼ ë°˜í™˜í•˜ê²Œ ë©ë‹ˆë‹¤.&gt;&gt;&gt; Shape.SQUARE&lt;Shape.SQUARE: 2&gt;&gt;&gt;&gt; Shape.ALIAS_FOR_SQUARE&lt;Shape.SQUARE: 2&gt;&gt;&gt;&gt; Shape(2)&lt;Shape.SQUARE: 2&gt;APIë¡œ ì—´ê±°í˜•ì„ ì „ë‹¬í• ë•Œ ê³ ë¯¼FastAPIëŠ” routerì˜ ìš”ì†Œë¥¼ ìë™ìœ¼ë¡œ ë¬¸ì„œí™”í•´ ì£¼ëŠ” ê¸°ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¬¸ì„œì‘ì„±ì˜ ì‹œê°„ì„ ìƒë‹¹ ë¶€ë¶„ ì¤„ì—¬ì£¼ì–´ ë§¤ìš° í¸ë¦¬í•œ ê¸°ëŠ¥ì´ë¼ê³  ìƒê°í•˜ëŠ”ë° Python ì—´ê±°í˜•ì— ëŒ€í•´ ì¡°ê¸ˆì€ ë¶€ì¡±í•œ ë¶€ë¶„ì´ ìˆì£ .class RequestEmailAuthType(str, Enum):    JOIN = '1'    RESET_PASSWORD = '2'...class RequestEmailAuthIn(CamelModel):    request_type: RequestEmailAuthType = Field(title='ìš”ì²­ íƒ€ì…')ìœ„ì™€ ê°™ì€ ì—´ê±°í˜•ì„ API ìš”ì²­ì—ì„œ í•„ë“œë¡œ ë°›ëŠ”ë‹¤ê³  ê°€ì •í•˜ë©´ redoc ë¬¸ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤.ì´ ë¬¸ì„œì—ëŠ” í•œ ê°€ì§€ í° ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ë°”ë¡œ \"1\"ê³¼\"2\"ê°€ ë¬´ì—‡ì„ ëœ»í•˜ëŠ”ì§€ ë¬¸ì„œë§Œ ë³´ì•„ì„œëŠ” ì•Œ ìˆ˜ê°€ ì—†ë‹¤ëŠ” ì ì´ì£ . ë‹¤í–‰íˆë„ ì´ ë¬¸ì œëŠ” ì¡°ê¸ˆ ê°„ë‹¨í•˜ê²Œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°”ë¡œ Pythonì˜ __doc__ ê¸°ëŠ¥ì„ ì´ìš©í•´ì„œì£ .class RequestEmailAuthType(str, Enum):    \"\"\"    1: ê°€ì…, 2: ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™”    \"\"\"    JOIN = '1'    RESET_PASSWORD = '2'ì´ëŸ° ì‹ìœ¼ë¡œ ì—´ê±°í˜•ì— __doc__í•­ëª©ì„ ì¶”ê°€í•´ ì£¼ë©´ redocì€ ì•„ë˜ì™€ ê°™ì´ ìë™ìœ¼ë¡œ ê°ê°ì˜ ê°’ì— ëŒ€í•œ ì„¤ëª…ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.SQLAlchemyì™€ì˜ ì—°ë™FastAPIì—ì„œ ORM ê¸°ëŠ¥ì„ ì´ìš©í•˜ê¸° ìœ„í•´ì„  SQLAlchemyë¼ëŠ” OpneSourceë¥¼ ì´ìš©í•©ë‹ˆë‹¤. ë§¤ìš° ì˜ ë§Œë“¤ì–´ì§„ OpenSourceì´ì§€ë§Œ Databaseì— ì—´ê±°í˜•ì˜ íƒ€ì…ì„ ë„£ì„ ë•Œ ì—´ê±°í˜•ì´ ê°’(value)ì´ ì•„ë‹Œ í‚¤(name)ê°€ ë“¤ì–´ê°„ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.í‚¤ê°€ ë“¤ì–´ê°€ëŠ” ê±´ ë‚˜ë¦„ ì˜ë¯¸ ìˆëŠ” ë°ì´í„°ê°€ ë“¤ì–´ê°€ëŠ” ê²ƒì´ë¼ ë°ì´í„° ë² ì´ìŠ¤ì˜ ê°’ì„ ì§ì ‘ ì—´ì–´ë³¼ ë•Œ ì¡°ê¸ˆì€ ë” ì§ê°ì ì¼ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆê¸´ í•˜ì§€ë§Œ, ìµœê·¼ ê°œë°œ ë™í–¥ìƒ ë°ì´í„°ë² ì´ìŠ¤ì— ì§ì ‘ ì ‘ê·¼í•´ì„œ CRUD ì‘ì—…ì„ í•˜ëŠ” ê²½ìš°ëŠ” ì˜ ì—†ë‹¤ ë³´ë‹ˆ ì €ì¥ë˜ëŠ” ë°ì´í„°ì˜ ìš©ëŸ‰ì„ ì¤„ì´ê¸° ìœ„í•´ ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë˜ ë³„ì¹­ì„ ì´ìš©í•´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.class RequestEmailAuthType(str, Enum):    JOIN = '1'    RESET_PASSWORD = '2'    J = '1'    R = '2'SQLAlchemyê°€ ì•Œì•„ì„œ ë³„ì¹­ë§Œì„ ì•Œì•„ì„œ ì¶”ë ¤ë‚¸ í›„ ë°ì´í„°ë² ì´ìŠ¤ì˜ í‚¤ë¡œ ì„¤ì •í•´ ì¤„ ìˆ˜ ìˆë‹¤ë©´ ë” ì´ìƒ ì†ë³¼ê²Œ ì—†ì–´ì§€ì§€ë§Œ, ì•„ì‰½ê²Œë„ ìœ„ ì½”ë“œë§Œìœ¼ë¡œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ìŠ¤í‚¤ë§ˆë¡œ enum í•„ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤.`request_type` enum('JOIN','RESET_PASSWORD','J','R') NOT NULL,Jì™€ Rë¡œ ë°ì´í„°ë¥¼ ì±„ìš¸ ìˆ˜ëŠ” ìˆì§€ë§Œ ì© ë§Œì¡±ìŠ¤ëŸ½ì§€ ì•ŠìŠµë‹ˆë‹¤. ì €ì¥ë˜ëŠ” ë°ì´í„°ì˜ í¬ê¸°ë¥¼ ì¤„ì—¬ë³´ìëŠ” ì˜ë„ì™€ ìƒì¶©ë˜ëŠ” ë¶€ë¶„ì´ ìˆê³ , ë¬´ì—‡ë³´ë‹¤ ë™ì¼í•œ ì˜ë¯¸ì˜ ê°’ì´ ì¤‘ë³µë˜ì–´ í‘œì‹œë  ìˆ˜ë„ ìˆë‹¤ëŠ” ì ì´ í˜¼ë€ì„ ì•¼ê¸°í•  ìˆ˜ë„ ìˆì„ ê²ƒ ê°™ë‹¤ëŠ” íŒë‹¨ì…ë‹ˆë‹¤.SQLAlchemyì—ì„œ Enumì„ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì„ ì‚´í´ë³´ë©´ ëŒ€ëµ ì•„ë˜ì™€ ê°™ì´ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.if len(enums) == 1 and hasattr(enums[0], \"__members__\"):    self.enum_class = enums[0]    _members = self.enum_class.__members__    aliases = [n for n, v in _members.items() if v.name != n]    if self._omit_aliases is NO_ARG and aliases:        util.warn_deprecated_20(            \"The provided enum %s contains the aliases %s. The \"            \"``omit_aliases`` will default to ``True`` in SQLAlchemy \"            \"2.0. Specify a value to silence this warning.\"            % (self.enum_class.__name__, aliases)        )__members__ë¥¼ í†µí•´ Enum í•„ë“œì— ë“¤ì–´ê°ˆ í•­ëª©ë“¤ì„ ê°€ì ¸ì˜¤ëŠ”ë°, ì•„ì‰½ê²Œë„ ë³„ì¹­ë§Œì„ ë„£ì„ ìˆ˜ ìˆëŠ” ì˜µì…˜ì´ ë”°ë¡œ ì—†ë„¤ìš”. ì›í‚¤ì™€ ë³„ì¹­ì˜ ìˆœì„œë¥¼ ë°”ê¾¼ í›„ (ë³„ì¹­ì„ ì›í‚¤ì²˜ëŸ¼ í™œìš©) _omit_aliasesì˜µì…˜ì„ ì¤„ê¹Œ ìƒê°í•´ ë³´ê¸°ë„ í•˜ì˜€ì§€ë§Œ, ë³„ì¹­ê³¼ ì›í‚¤ì˜ ìˆœì„œë¥¼ ë³´ì¥í•˜ê³  ì‹¶ë‹¤ëŠ” ìƒê°ì— __members__ë¥¼ ì¡°ê¸ˆ ìˆ˜ì •í•´ ë³´ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤.class AliasOnlyEnumMeta(EnumMeta):    @property    def __members__(cls):        sp = super().__members__        items = sp.items()        alias_values = [v.value for n, v in items if v.name != n]        filtered = [n for n, v in items if (v.name == n and v.value not in alias_values) or v.name != n]        members = {k: v for k, v in items if k in filtered}        return membersclass RequestEmailAuthType(str, Enum, metaclass=AliasOnlyEnumMeta):    JOIN = '1'    RESET_PASSWORD = '2'    J = '1'    R = '2'Enumì˜ metaclassë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•œ AliasOnlyEnumMetaë¥¼ ìƒì„± í›„ __members__ propertyë¥¼ override í•´ì„œ ë³„ì¹­ì´ ì—†ëŠ” í‚¤ì™€ ë³„ì¹­ì´ ìˆë‹¤ë©´ ë³„ì¹­ ë§Œì„ ë‚´ë ¤ ì£¼ë„ë¡ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.ì´ì œ ì´ ì½”ë“œë¥¼ ì ìš©í•´ì„œ ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±í•´ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ Fieldê°€ ìƒì„±ë˜ëŠ” ê±¸ í™•ì¸í• ìˆ˜ ìˆì£ .`request_type` enum('J','R') NOT NULL,Enumì˜ ê°’ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” í‚¤ê°€ ìƒë‹¹íˆ ê°„ê²°í•´ì§„ ëŠë‚Œì€ ìˆì§€ë§Œ, ì´ì œ ì•½ìë¡œ í‘œí˜„ëœ í•„ë“œì˜ ê°’ì´ ë¬´ì—‡ì´ ì˜ë¯¸í•˜ëŠ”ì§€ ì‰½ê²Œ í•´ì„ì´ í˜ë“¤ì–´ì§€ëŠ” ë¬¸ì œê°€ ìƒê¸°ë„¤ìš”. SQLAlchemyì—ì„œ ì œê³µí•˜ëŠ” commentí‚¤ì›Œë“œì— redocì—ì„œ ì‚¬ìš©í–ˆë˜ ê²ƒê³¼ ê°™ì´ __doc__ ì´ìš©í•´ í•´ë‹¹ í‚¤ì˜ ì˜ë¯¸ë¥¼ ì„¤ëª…ìœ¼ë¡œ ë„£ì–´ë³´ê² ìŠµë‹ˆë‹¤.request_type = Column(Enum(RequestEmailAuthType), comment=RequestEmailAuthType.__doc__, nullable=False)ì´ì œ ìƒì„±ëœ ìŠ¤í‚¤ë§ˆë¥¼ ë³´ë©´ htmlê³¼ ì¼ë°˜ textì˜ ì°¨ì´ ë•Œë¬¸ì— ìƒê°í–ˆë˜ ê²ƒê³¼ëŠ” ì¡°ê¸ˆ ë‹¤ë¥¸ í˜•íƒœì˜ commentê°€ ë¶™ì–´ìˆëŠ” ê±¸ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`request_type` enum('J','R') NOT NULL COMMENT '\\n        1: ê°€ì…, 2: ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™”\\n        ',ì–´ë–»ê²Œ ë³¸ë‹¤ë©´ ë³„ë¬¸ì œ ì•„ë‹Œ ê²ƒ ê°™ì§€ë§Œ ë§Œë“¤ë‹¤ ë§Œ ê²ƒ ê°™ì€ ëŠë‚Œì˜ ê²°ê³¼ëŠ” ìš©ë‚©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. commentí‚¤ì›Œë“œì— ì¼ì¼ì´ ì£¼ì„ì„ ë‹¬ì•„ì£¼ëŠ” ê²ƒë„ ì¢‹ì€ ë°©ë²•ì´ ë  ìˆ˜ ìˆì§€ë§Œ, ìˆ˜ì‘ì—…ì´ ë§ì•„ì§„ë‹¤ëŠ” ê±´ ê·¸ë§Œí¼ ì‹¤ìˆ˜ì˜ ê°€ëŠ¥ì„±ì´ ì»¤ì§„ë‹¤ëŠ” ê²ƒê³¼ ë™ì¼í•œ ì˜ë¯¸ì´ê¸° ë•Œë¬¸ì— ì´ê²ƒì„ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆëŠ” ë¬´ì–¸ê°€ë¥¼ ë§Œë“¤ì–´ì•¼ê² ë‹¤ëŠ” ìƒê°ì„ í•˜ê³  ë‹¤ìŒê³¼ ê°™ì´ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤.class AnnotatedEnum(Enum):    def __new__(cls, *args, **kwargs):        tu = cls.__bases__        if len(tu) == 1:            # plain Enum            t = object            pass        else:            t = tu[0]        obj = t.__new__(cls)        obj._value_ = args[0]        return obj    def __init__(self, _, desc: str = None):        self.desc = desc    @classmethod    @property    def comment(cls):        items = cls.__members__.items()        docs = [f'{n}: {v.desc}' for n, v in items]        return ', '.join(docs)class RequestEmailAuthType(str, AnnotatedEnum, metaclass=AliasOnlyEnumMeta):    \"\"\"    1: ê°€ì…, 2: ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™”    \"\"\"    JOIN = '1', 'íšŒì›ê°€ì…'    RESET_PASSWORD = '2', 'ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™”'    J = '1'    R = '2'...request_type = Column(Enum(RequestEmailAuthType), comment=RequestEmailAuthType.comment, nullable=False)Python ì—´ê±°í˜•ì— ì„¤ëª…ì„ ë‹¬ì•„ì¤„ ìˆ˜ ìˆëŠ” AnnotatedEnumì„ ë§Œë“¤ì–´ í•˜ìœ„ í´ë˜ìŠ¤ë¡œ RequestEmailAuthTypeì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤. ì´ì œ JOIN = '1', 'íšŒì›ê°€ì…'ì´ëŸ° ì‹ìœ¼ë¡œ Tuple í˜•íƒœë¡œ ì—´ê±°í˜•ì˜ ê°’ì„ ì§€ì •í•  ìˆ˜ ìˆê³ , ë‘ ë²ˆì§¸ ì¸ìëŠ” descì— ìë™ìœ¼ë¡œ ë§¤í•‘ ë˜ë„ë¡ ë§Œë“¤ì–´ì£¼ì—ˆê³ , ì´ëŸ° ì‹ì˜ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì¥ì ì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  í‚¤, ê°’, ì„¤ëª…ì„ í•œ ì¤„ë¡œ ì²˜ë¦¬ë¥¼ í•´ì„œ ë³´ë‹¤ ì§ê´€ì ìœ¼ë¡œ í•´ì„ì´ ê°€ëŠ¥í•˜ë‹¤.  í‚¤ê°€ ìƒˆë¡œ ìƒê¸°ê±°ë‚˜ ì‚­ì œë  ë•Œ __doc__ì²˜ë¦¬ì˜ ëˆ„ë½ì„ ìµœì†Œí™”í•  ìˆ˜ ìˆë‹¤.ìœ„ ë°©ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ë‚¸ ìŠ¤í‚¤ë§ˆë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì¢€ ë” ê¹”ë”í•œ ì„¤ëª…ì„ ë‚¨ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`request_type` enum('J','R') NOT NULL COMMENT 'J: íšŒì›ê°€ì…, R: ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™”',redocì—ì„œë„ Annotationì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ê¹Œ?í‚¤ì™€ ê°’, ê·¸ë¦¬ê³  ì„¤ëª…ì„ í•œ ì¤„ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ ë§Œë“¤ì—ˆë‹¤ë©´ ì´ë¥¼ ë‹¤ë¥¸ ê³³ì—ì„œë„ í™œìš©í•  ìˆ˜ ìˆëŠ” ê²Œ ë” ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì–´ ì•ì„œ ë§Œë“  AliasOnlyEnumMetaí´ë˜ìŠ¤ë¥¼ ìƒì„±í•  ë•Œì— ëª‡ ê°€ì§€ ìˆ˜ì •ì‚¬í•­ì„ ë„£ì–´ ì—´ê±°í˜•ì˜ __doc__ì„ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ ì£¼ëŠ” ê¸°ëŠ¥ì„ ë„£ì–´ë´¤ìŠµë‹ˆë‹¤.redocì€ html íƒœê·¸ë¥¼ ì§€ì›í•˜ë‹¤ ë³´ë‹ˆ í‚¤ì™€ ê°’ì— ëŒ€í•œ ì„¤ëª…ì— ì•½ê°„ì˜ ê°•ì¡° ì²˜ë¦¬ë„ í•¨ê»˜ ì ìš©ì‹œì¼œë³´ì•˜ì£ .class AliasOnlyEnumMeta(EnumMeta):    def __new__(metacls, cls, bases, classdict, **kwargs):        obj = super(AliasOnlyEnumMeta, metacls).__new__(metacls, cls, bases, classdict, **kwargs)        members = obj.__members__        _desc_list = [            f'&lt;em&gt;{v.value}&lt;/em&gt; : &lt;strong&gt;{v.desc or \"-\"}&lt;/strong&gt;'            for _, v in members.items() if hasattr(v, 'desc')        ]        obj.__doc__ = ', '.join(_desc_list)        return objìœ„ ì½”ë“œë¥¼ ì´ìš©í•´ redoc ë¬¸ì„œë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ê°•ì¡°ë˜ëŠ” í•­ëª©ë“¤ì´ ìƒê²¨ë‚¬ìŠµë‹ˆë‹¤.ì²˜ìŒë³´ë‹¤ í›¨ì”¬ ë³´ê¸° ì¢‹ì€ ë¬¸ì„œê°€ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤. ë˜í•œ ì—´ê±°í˜•ì— ê°œë°œìê°€ ì„œìˆ í•œ __doc__ì„ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ë©´ì„œ ë©”ëª¨ë¦¬ìƒì˜ __doc__ë§Œì„ ë³€ê²½ì²˜ë¦¬í•˜ì—¬, ì—´ê±°í˜•ì˜ Overviewë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ë©´ì„œ API / Databaseì˜ ì„¤ëª…ë§Œì„ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ ì£¼ëŠ” í˜•ì‹ì´ë¼ ì—¬ëŸ¬ ê°€ì§€ë¡œ íš¨ìœ¨ì„±ì´ ì¦ëŒ€ë˜ëŠ” ë°©ì‹ì„ ë§Œë“¤ì–´ ë‚¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤."
  },
  
  {
    "title": "FastAPI ìœ íš¨ì„± ê²€ì‚¬",
    "url": "/posts/fast-api-validator/",
    "categories": "python, backend",
    "tags": "pydantic, validate, fastapi",
    "date": "2022-04-25 09:00:00 +0900",
    





    
    "snippet": "Request Body ValidateAPI ìš”ì²­ì„ ë°›ìœ¼ë©´ ìµœì†Œí•œìœ¼ë¡œ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ” ìœ íš¨ì„± ê²€ì‚¬ê°€ ìˆìŠµë‹ˆë‹¤. ë³´ì•ˆì˜ ê°€ì¥ ê¸°ë³¸ì¸ SQL Injection ê³µê²© ì´ì™¸ì—ë„ ì „ë‹¬ë°›ì€ ë°ì´í„°ê°€ í•„ìš”ë¡œ í•˜ëŠ” ìµœì†Œí•œì˜ ê·œì¹™ ë“±ì´ ìˆìŠµë‹ˆë‹¤.passwordë¥¼ ì˜ˆë¡œ ë“¤ìë©´ ëŒ€ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ ìµœì†Œ 8ì—ì„œ ìµœëŒ€ 20ìë¦¬ê¹Œì§€ì˜ í…ìŠ¤íŠ¸ë¥¼ ë§Œì¡±í•œë‹¤ë˜ê°€ í˜¹ì€ ...",
    "content": "Request Body ValidateAPI ìš”ì²­ì„ ë°›ìœ¼ë©´ ìµœì†Œí•œìœ¼ë¡œ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ” ìœ íš¨ì„± ê²€ì‚¬ê°€ ìˆìŠµë‹ˆë‹¤. ë³´ì•ˆì˜ ê°€ì¥ ê¸°ë³¸ì¸ SQL Injection ê³µê²© ì´ì™¸ì—ë„ ì „ë‹¬ë°›ì€ ë°ì´í„°ê°€ í•„ìš”ë¡œ í•˜ëŠ” ìµœì†Œí•œì˜ ê·œì¹™ ë“±ì´ ìˆìŠµë‹ˆë‹¤.passwordë¥¼ ì˜ˆë¡œ ë“¤ìë©´ ëŒ€ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ ìµœì†Œ 8ì—ì„œ ìµœëŒ€ 20ìë¦¬ê¹Œì§€ì˜ í…ìŠ¤íŠ¸ë¥¼ ë§Œì¡±í•œë‹¤ë˜ê°€ í˜¹ì€ ì „í™”ë²ˆí˜¸ëŠ” ìˆ«ìì™€ +- ë“±ìœ¼ë¡œë§Œ êµ¬ì„±ì´ ë˜ì–´ìˆëŠ”ì§€ íŒë‹¨í•  ê²½ìš°ê°€ ìƒê¸°ê¸° ë§ˆë ¨ì´ì£ .FastAPI ì—ì„œëŠ” pydantic ì´ë¼ëŠ” Opensource ë¥¼ í†µí•´ì„œ ê²€ì¦í•  ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤.BaseModelpydantic ì—ì„œ ì œê³µí•˜ëŠ” BaseModelê³¼ Fieldë¥¼ ì´ìš©í•˜ë©´ ê¸°ë³¸ì ì¸ ìœ íš¨ì„± ê²€ì¦ì„ ì†ì‰½ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìœ¼ë©°, ì§ì ‘ ìœ íš¨ì„± ê²€ì¦ì„ í•˜ëŠ” ì½”ë“œë¥¼ ì‚½ì…í•˜ëŠ” ê²ƒ ë³´ë‹¤ í›¨ì”¬ ì§ê´€ì ì´ê³  ê°„í¸í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.from pydantic import BaseModelclass ModelIn(BaseModel):    password: str = Field(title='ë¹„ë°€ë²ˆí˜¸', regex='^(?=.*[a-zA-Z])(?=.*[!@#$%^*+=-])(?=.*[0-9]).{8,20}$')    id: Optional[int] = Field(title='ID', default=None, ge=0)    class Config:        orm_mode = Trueìœ„ ì˜ˆì‹œëŠ” passwordì˜ ê²½ìš° ëŒ€ì†Œë¬¸ìì™€ ìˆ«ì ê·¸ë¦¬ê³  íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•œ 8~20ìë¦¬ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ í—ˆìš©, idëŠ” null í˜¹ì€ 0ë³´ë‹¤ í° ìˆ«ìë§Œ í—ˆìš©í•œë‹¤ëŠ” ìœ íš¨ì„± ê²€ì¦ì˜ ì˜ˆì‹œì…ë‹ˆë‹¤.@validatorFieldì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ëŠ” gt, lt, min_lengthâ€¦ ë“±ë§Œìœ¼ë¡œë„ ìƒë‹¹ìˆ˜ì˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ë§Œì¡±í•  ìˆ˜ëŠ” ìˆì§€ë§Œ, ì‚¬ìš©ì ì •ì˜ ìœ íš¨ì„± ê²€ì‚¬ ë° ê°œì²´ ê°„ì˜ ë³µì¡í•œ ê´€ê³„ëŠ” @ decoratorë¥¼ í†µí•´ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.class UserModel(BaseModel):    name: str = Field()    email: str = Field()    password: str = Field()    @validator('name')    def name_must_contain_space(cls, v):        if ' ' not in v:            raise ValueError('must contain a space')        return vìœ„ ì½”ë“œëŠ” ë³€ìˆ˜ nameì— ëŒ€í•œ customized validatorë¡œ @validator({í•„ë“œëª…}) ìœ¼ë¡œ ì²˜ë¦¬ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ í•„ë“œëª…ì€ ë³µìˆ˜ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë©° ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.@validator('email', 'password')def decrypt_fields(cls, raw):    ...    return@root_validatorí•„ë“œë³„ ìœ íš¨ì„± ê²€ì¦ ì™¸ì—ë„ ìš”ì²­ë°›ì€ ì „ì²´ ëª¨ë¸ì˜ ìœ íš¨ì„± ê²€ì¦ì„ í•´ì•¼ í•˜ëŠ” ê²½ìš°ë„ í•„ìš”í•©ë‹ˆë‹¤.ì˜ˆë¥¼ ë“¤ë©´ ë³µìˆ˜ì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ì „ë‹¬ë°›ì•˜ì„ ë•Œ ì „ì²´ í•­ëª©ì—ì„œ ì¤‘ë³µëœ ê°’ì´ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ íŒë³„í•˜ëŠ”ë° ì“°ì¼ ìˆ˜ë„ ìˆì£ .class OrganizationModelIn(BaseModel):    industries: List[IndustryModelIn] = Field()    ...    @root_validator    def duplicate_not_allowed(cls, values):        industries = values.get('industries')        ids = [industry.id for industry in industries]        id_set = set(ids)        if len(id_set) != len(ids):            raise ValueError('industry id`s duplicate not allowed')        return valuesE2EE (End to End Encryption)íŒ¨ìŠ¤ì›Œë“œë‚˜ ê¸°íƒ€ ì‹ë³„ë°ì´í„°ëŠ” HTTPS í”„ë¡œí† ì½œì„ ì‚¬ìš©í•œë‹¤ê³  í•˜ë”ë¼ë„ ì•”í˜¸í™”ë¥¼ ê±°ì³ ì¢…ë‹¨ ê°„ì— í†µì‹ ì´ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤.ìœ„ì—ì„œ password í•„ë“œì— ì •ê·œì‹ ^(?=.*[a-zA-Z])(?=.*[!@#$%^*+=-])(?=.*[0-9]).{8,20}$ì„ ë„£ì—ˆì§€ë§Œ, ì•”í˜¸í™”ëœ í•„ë“œ ê°’ìœ¼ë¡œëŠ” ì• ì´ˆì— ì •ê·œì‹ì„ íŒë³„í•  ìˆ˜ ì—†ë‹¤ëŠ” ë¬¸ì œê°€ ìˆìœ¼ë©°,ì´ì— pydanticì—ì„œëŠ” validator decoratorì— pre=í‚¤ì›Œë“œë¥¼ ì´ìš©í•´ validate í•¨ìˆ˜ë¥¼ ë¨¼ì € í˜¸ì¶œí•œ í›„ í•„ë“œì— ì ìš©ëœ ì •ê·œì‹ì„ ê²€ì‚¬í•  ìˆ˜ ìˆë„ë¡ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.@validator('email', 'password', pre=True)def decrypt_fields(cls, raw):    from app.core.utils.crypto import rsa    try:        dec = rsa.dec(raw)    except Exception as e:        from app.core.errors.exceptions import CommonExceptions        raise CommonExceptions.InvalidEncryptionField(e)    return decì´ë ‡ê²Œ validate í•¨ìˆ˜ë¥¼ êµ¬í˜„í•´ ë†“ìœ¼ë©´ 1ì°¨ë¡œ decrypt_fields í•¨ìˆ˜ë¥¼ ë¨¼ì € ì‹¤í–‰, ë³µí˜¸í™”ëœ ê°’ì„ í† ëŒ€ë¡œ ë‹¤ì‹œ í•œë²ˆ Fieldì— ì ìš©ëœ validate ê²€ì‚¬ë¥¼ ì§„í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.Validator Sequencevalidator decoratorë¥¼ í†µí•´ ìœ íš¨ì„± ê²€ì¦ì„ í•˜ê²Œ ë˜ë©´@validatorê°€ ë¨¼ì € ì‹¤í–‰ë˜ê³ , @root_validatorê°€ ë‚˜ì¤‘ì— ì‹¤í–‰ ë˜ê²Œ ë©ë‹ˆë‹¤. ê° validate í•¨ìˆ˜ì— printë¥¼ ì°ì–´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤@validator('email', 'password', pre=True)def decrypt_fields(cls, raw):    print(f'decrypt_fields')    ...    return dec@root_validatordef root_validator(cls, values):    print(f'root_validator')    return valuesdecrypt_fieldsdecrypt_fieldsroot_validator2%ë¶€ì¡±í•œ BaseModelìš”ì²­ì„ ë°›ì€ Body ë°ì´í„° ì¤‘ì— industriesì˜ idê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ìˆëŠ”ì§€ë¥¼ í™•ì¸í•´ì•¼ ìƒˆë¡œ ìƒì„±ëœ ëª¨ë¸ê³¼ì˜ ì œëŒ€ë¡œ ëœ ê´€ê³„ ì„¤ì •ì„ í•  ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤.Djangoì˜ drfë¥¼ í†µí•´ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ê²½í—˜í•´ ë³´ì•˜ë˜ ì œê²ŒëŠ” Serializer ì•ˆì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ORM ê°ì²´ì™€ ê´€ë ¨ í•¨ìˆ˜ì— ëŒ€í•œ ì•„ì‰¬ì›€ì´ ìƒë‹¹íˆ ë§ì´ ë‚¨ì•„async def some(session: Session = Depends(get_db)):    ...    returnë“±ê³¼ ê°™ì´ Dependsí•¨ìˆ˜ë¥¼ í†µí•´ database session ì„ ê°€ì ¸ì˜¤ëŠ” ê²ƒì²˜ëŸ¼ BaseModelì—ì„œë„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì§€ ì•Šì„ê¹Œë¼ëŠ” ìƒê°ì„ í•˜ë©° ì—¬ëŸ¬ ê°€ì§€ ì‹œë„ë¥¼ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.í•˜ì§€ë§Œ pydanticì—ì„œ sqlalchemyë¥¼ í•˜ë‚˜ì˜ ì»¤ë„¥ì…˜ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•ì— ë“œë¼ë§ˆí‹±í•œ ë°©ì‹ì€ ì—†ë‹¤ëŠ” ìª½ìœ¼ë¡œ ê²°ë¡ ì„ ë‚´ê³  Request Bodyì˜ ìœ íš¨ì„± ê²€ì¦ì´ ëª¨ë‘ ëë‚œ í›„ Dependsë¥¼ í†µí•´ ì „ì²´ì ìœ¼ë¡œ ìœ íš¨ì„± ê²€ì¦ì„ í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.def model_in(model: OrganizationModelIn, database: Session = Depends(get_db)):    industries = model.industries    errors = []    from pydantic.error_wrappers import ErrorWrapper    for idx, industry in enumerate(industries):    if industry.id and 0 &lt; industry.id and not is_exists_industry(database, industry.id):        e = OrganizationExceptions.Join.UnDefinedIndustryId        errors.append(ErrorWrapper(e(industry.id), loc=('body', 'industries', idx, 'id')), )    if len(errors) != 0:        raise ValidationException(errors=errors, model=model)    return model, database@router.post()async def post_join(model_n_session=Depends(model_in)):    ...    returncrudì—ì„œ raise ì²˜ë¦¬ë¥¼ í•˜ëŠ” ê±¸ ê³ ë¯¼í•´ ë³´ì•˜ìœ¼ë‚˜, is_exists_industryí•¨ìˆ˜ëŠ” industry.idì— 1:1ë¡œ ëŒ€ì‘í•˜ëŠ” ê²Œ ë‚«ê² ë‹¤ëŠ” íŒë‹¨ì— model_inì´ë¼ê³  í•˜ëŠ” validate í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.ìœ„ì™€ ê°™ì´ ì‹¤ì œ routerì— ì œê³µë˜ëŠ” ë©”ì„œë“œì—ì„œ model_inì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ í†µí•´ sessionì„ í•˜ë‚˜ì˜ ì»¤ë„¥ì…˜ìœ¼ë¡œ ë¬¶ì–´ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ìœ íš¨ì„± ê²€ì¦ì„ ìˆ˜í–‰í•˜ë„ë¡ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.  CRUD ë‹¨ì—ì„œ ë°ì´í„°ë¥¼ Insert í•  ë•Œì— ì‹¤ì œ ìœ íš¨í•œ IDë¥¼ ì „ë‹¬ë°›ì€ ê²ƒì¸ì§€ í™•ì¸í•´ ë³¼ ìˆ˜ë„ ìˆì—ˆì§€ë§Œ, CRUD ê°ê°ì˜ í•¨ìˆ˜ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ë¬¸ì œ, ê·¸ë¦¬ê³ , pydanticì´ ê¸°ë³¸ì ìœ¼ë¡œ ë§¤ê°œë³€ìˆ˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µê³¼í•˜ì§€ ëª»í•  ë•Œ ë‚´ë ¤ì£¼ëŠ” 422 ì—ëŸ¬ì™€ ë™ì¼í•œ í˜•íƒœì¸{  \"detail\": [    {      \"loc\": [\"body\", \"industries\", 0],      \"msg\": \"ì •ì˜ ë˜ì§€ ì•Šì€ Industry ê°ì²´ì˜ ID({id})ê°€ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤\",      \"type\": \"type_error\"    }  ]}ì²˜ëŸ¼ ë‚´ë ¤ ì£¼ê³  ì‹¶ë‹¤ëŠ” ê³ ì§‘ë•Œë¬¸ì— ìœ„ì™€ ê°™ì€ í˜•íƒœë¥¼ ê³ ì•ˆí•´ ë³´ì•˜ë„¤ìš”.ì´ì „ APIì™€ì˜ ë™ì§ˆí™”ì•„ì´ë©”ë””ì‹ ì˜ APIëŠ” FastAPI ì™¸ì—ë„ SpringBootë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. API Hostì™€ ResponseëŠ” ì–´ì©” ìˆ˜ ì—†ì´ ë‹¤ë¥¸ í˜•íƒœë¡œ ì‚¬ìš©í•œë‹¤ê³  í•˜ë”ë¼ë„ FrontEnd ìª½ì—ì„œ ì²˜ë¦¬í•˜ëŠ” ë³€ìˆ˜ëª… ëª…ëª… ê·œì¹™ì„ ìµœëŒ€í•œ ë³€í™”ë¥¼ ì£¼ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•´ì„œ CamelCase ë¬¸ë²•ì„ ë”°ë¥´ë„ë¡ ìˆ˜ì •ì„ í•´ì£¼ì–´ì•¼ í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤.pydantic Fieldì—ëŠ” alias=ë¥¼ í†µí•´ ë‚´ë¶€ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ëª…ê³¼ request / responseì—ì„œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ëª…ì„ ë‹¤ë¥´ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ë©´field_name = str = Field(alias='fieldName')ìœ„ì™€ ê°™ì´ FastAPI ë‚´ë¶€ì—ì„œëŠ” pythonì˜ ë³€ìˆ˜ í˜•íƒœì¸ field_name ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©´ì„œ ì™¸ë¶€ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ëª…ì€ fieldNameìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê±´ë°ìš”.ëª¨ë“  í•„ë“œëª…ì— ì´ëŸ° ì‹ìœ¼ë¡œ aliasë¥¼ ë¶™ì´ëŠ” ê±´ íš¨ìœ¨ì„±ì´ ë–¨ì–´ì§„ë‹¤ëŠ” ë¬¸ì œì ì´ ìˆì–´ pyhumpsë¥¼ ì´ìš©í•´ BaseModelì„ ìƒì†ë°›ì€ CamelModelì„ ì‚¬ìš©í•´ ë³´ëŠ” ê²ƒìœ¼ë¡œ ë°©í–¥ì„ ì¡ì•„ ë³´ì•˜ìŠµë‹ˆë‹¤.from humps import camelizeclass CamelModel(BaseModel):    class Config:        alias_generator = camelize        allow_population_by_field_name = Trueì´ì œ BaseModel ëŒ€ì‹  CamelModelì„ impliment í•˜ëŠ” ê²ƒìœ¼ë¡œ Feild(alias=)ë¥¼ ìƒëµí•  ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤.class IndustryModelIn(CamelModel):    id: Optional[PositiveInt] = Field(title='ID', default=None)    industry_title: Optional[str] = Field(title='ì‚°ì—… ëª…', default=None)ìœ„ ëª¨ë¸ì— ëŒ€ì‘í•˜ëŠ” Request BodyëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤{  \"id\": null,  \"industryTitle\": \"title\"}ë§ˆì¹˜ë©°ë°¸ë¦¬ë°ì´ì…˜ì„ ì²˜ë¦¬í•˜ëŠ” ë° ìˆì–´ ì–´ëŠ ì •ë„ê¹Œì§€ ê¹Šê²Œ êµ¬í˜„í•˜ëŠëƒëŠ” APIì˜ í¼í¬ë¨¼ìŠ¤ì™€ë„ í¬ê²Œ ì˜í–¥ì´ ìˆë‹¤ ë³´ë‹ˆ, ë¬´í„±ëŒ€ê³  ì•„ë¬´ë ‡ê²Œë‚˜ ì‚´ì„ ë¶™ì´ê¸°ëŠ” ì–´ë ¤ìš´ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë”ìš±ì´ í‘œì¤€ì„ ì¤‘ìš”ì‹œí•˜ëŠ” ì œê²Œ ë¬¸ì„œì—ì„œ ì¶”ì²œí•˜ì§€ ì•ŠëŠ” ë””ìì¸ íŒ¨í„´ì„ ì ìš©í•œë‹¤ëŠ” ê±´ ê±°ë¶€ê°ì´ ìƒë‹¹íˆ ë§ì´ ë“¤ê¸°ë„ í–ˆì§€ë§Œ, ì–´ë–»ê²Œë“  ì‘ë‹µì˜ í˜•íƒœë¥¼ ë§ì¶”ê³  ì‹¶ë‹¤ëŠ” ìš•ë§ê³¼ì˜ ì‹¸ì›€ì´ ì‚½ì§ˆì„ í•œì°¸ì´ë‚˜ í•˜ê²Œ ëœ ì´ìœ ê°€ ëœ ê²ƒ ê°™ê¸°ë„ í•˜ë„¤ìš”.ì‹¤ì œë¡œ Django/DRFë¥¼ ì‚¬ìš©í•˜ë‹¤ APIì˜ í¼í¬ë¨¼ìŠ¤ ê°œì„ ì„ ìœ„í•´ FastAPIë¡œ í™˜ê²½ì„ êµ¬ì„±í•˜ì˜€ìœ¼ë‚˜, ê·¸ ì¥ì ì„ ì‚´ë¦¬ì§€ ëª»í•œë‹¤ë©´ FastAPIë¡œ ê°ˆì•„íƒ„ ì´ìœ ê°€ ì—†ë‹¤ëŠ” ìƒê°ì„ ë§ì´ í•˜ê²Œ ëœ ì‹œê°„ì„ ê°€ì¡ŒìŠµë‹ˆë‹¤."
  }
  
]

