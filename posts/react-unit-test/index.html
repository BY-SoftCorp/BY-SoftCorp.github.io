<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="ViewModel과 Model 유닛 테스트하기" />
<meta name="author" content="한 재연" />
<meta property="og:locale" content="ko_KR" />
<meta name="description" content="유닛 테스트란 어떤 단위의 모듈이 의도한 대로 동작하는지 확인하기 위한 과정입니다. 테스트 대상 단위가 정확하게 정해져있는 것은 아니지만, 이 단위의 크기를 작게 만들수록 테스트 코드를 작성하기가 쉽습니다. 데이터를 가져오는 로직과 그 데이터를 가공하는 로직, 그리고 가공한 데이터를 화면에 출력하는 로직이 하나의 컴포넌트에 전부 들어가있다고 생각해봅시다. 이 경우, 컴포넌트가 리턴하는 UI는 테스트해볼 수 있다고 하더라도, 컴포넌트 안에 얽혀있는 모든 함수들을 하나씩 뽑아내 테스트하기는 현실적으로 어렵습니다. 이러한 관점에서 MVVM 패턴은 유닛테스트를 진행하기 정말 좋은 패턴입니다. 모든 로직을 관리하던 컴포넌트에서 비즈니스 로직만을 따로 떼어내 함수 또는 클래스로 분리한 것이라고 보면 됩니다. 하나의 목적을 가지고 깔끔하게 분리된 함수와 클래스(ViewModel &amp; Model)는 View와는 독립적으로 테스트를 진행할 수 있습니다. 유닛 테스트를 진행하게 된 이유 유닛 테스트는 당장 이 기능이 잘 돌아가는지 확인해주는 역할도 하지만, 리팩토링을 진행할 때 의도치 않게 코드가 하는 기능이 바뀌는 상황을 방지해주기도 합니다. 따라서 현재 진행하고 있는 회사 프로젝트의 코드가 예상치 못하게 변경되지 않도록 테스트 코드를 작성하게 되었습니다. 여태껏 만들었던 여러개의 Model과 ViewModel의 테스트 코드를 작성하면서, 각 함수와 클래스에 맞는 테스트 코드를 작성하기 위해 많은 고민을 했습니다. 테스트는 발생할 수 있는 상황을 최대한 고려해야하기 때문에 테스트 파일마다 정말 다른 케이스를 테스트하게 됩니다. 이번 글은 특정 함수/클래스가 어떤 데이터를 받고 어떤 값을 반환하는지를 파악하고, 어떻게 테스트를 해야하는지를 고민했던 과정을 남겨보려 합니다. 테스팅 프레임워크는 Jest를 사용했습니다. Model 유닛 테스트 Model은 데이터를 받아오고 가공하는 역할을 합니다. 따라서 데이터가 들어온대로 잘 출력되는지, 가공하는 로직이 있다면 가공된 대로 형식이 잘 바뀌었는지를 테스트했습니다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 class PostItem implements PostItemType { private readonly title: string private readonly content: string private readonly tags: string[] private readonly created: string private readonly thumbContent: string constructor(raw: PostDataType) { this.title = raw.title this.content = raw.content this.tags = raw.tags this.created = TimeLang(raw.created) this.thumbContent = DeleteTags.convert(raw.content) } getTitle = () =&gt; this.title getContent = () =&gt; this.content getTags = () =&gt; this.tags getCreated = () =&gt; this.created getThumbContent = () =&gt; this.thumbContent 이 Model을 한번 테스트 해보겠습니다. 게시글 데이터를 받아와서 각 속성에 따라 출력해야 하는 값을 설정해주고 있네요. 유닛 테스트를 할 때는 목업 데이터를 사용해야 합니다. 서버 데이터를 사용하게 되면 네트워크 작업으로 인한 속도 저하, 실제 데이터의 변경, 그로 인해 테스트를 진행할때마다 나오는 결과값이 달라지는 등 여러 단점들이 생기기 때문입니다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 describe(&#39;PostItem Model 테스트&#39;, () =&gt; { let item: PostItem beforeEach(() =&gt; { item = new PostItem({ title: &#39;Hello&#39;, content: &#39;&lt;div&gt;Nice to meet you!&lt;/div&gt;&#39;, tags: [&#39;flower&#39;, &#39;tree&#39;, &#39;butterfly&#39;], created: &#39;2024-05-02T00:11:17.289362+09:00&#39;, }) }) test(&#39;기본값 출력&#39;, () =&gt; { expect(item.getTitle()).toBe(&#39;Hello&#39;) expect(item.getContent()).toBe(&#39;&lt;div&gt;Nice to meet you!&lt;/div&gt;&#39;) expect(item.getTags()).toEqual([&#39;flower&#39;, &#39;tree&#39;, &#39;butterfly&#39;]) expect(item.getCreated()).toBe(&#39;2024년 5월 2일&#39;) expect(item.getThumbContent()).toBe(&#39;Nice to meet you!&#39;) }) }) 게시글 데이터과 똑같은 형식을 가진 가짜 테스트 데이터를 만들어주었습니다. 그리고 beforeEach 메서드로 테스트를 진행하기 전마다 테스트 하고자 하는 변수값이 제가 만든 가짜 데이터로 초기화되도록 했습니다. 마지막으로 Model이 올바른 값을 리턴하는지 확인하기 위해 각 메서드의 반환값을 하나씩 빠짐없이 테스트를 돌려주었습니다. toBe, toEqual 등Matcher 함수가 결과값에 적절하게 사용되었는지도 확인해주었고요. 그런데 테스트를 돌리니 에러가 발생했습니다. 어려울게 없는 코드인데 왜 에러가 났을까 하고 문제를 찾아보니 getCreated() 메서드에서 사용하는 함수 때문이었습니다. 해당 함수에서는 i18n과 moment라는 외부 라이브러리를 사용해서 사용자의 위치 또는 사용자가 웹사이트에서 설정한 언어로 날짜를 반환해주고 있습니다. 그렇게 되면 위치나 사용자 설정에 따라 결과값이 달라지는 외부 의존성이 생기게 됩니다. 이런 현상을 방지하기 위해 jest.mock() 메서드를 사용해 외부 라이브러리를 mocking 해주어야 하는 것이지요. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 jest.mock(&#39;@src/locales/i18n&#39;, () =&gt; ({ __esModule: true, use: () =&gt; {}, init: () =&gt; {}, default: { t: (k: string) =&gt; k, language: &#39;ko&#39;, }, })) jest.mock(&#39;moment/dist/locale/ko&#39;, () =&gt; &#39;ko-kr&#39;) describe(&#39;&#39;PostItem Model 테스트&#39;&#39;, () =&gt; { // ... Model 테스트 코드 }) i18n의 기본 설정파일을 mocking하고, 테스트를 진행하는 위치나 환경에 상관없이 한국어 날짜 형식만을 반환하도록 디폴트값을 변화시켜주었습니다. 그리고 moment 라이브러리도 테스트를 진행할 때 문제없이 텍스트 변환을 할 수 있게 한국어 파일을 mocking 했습니다. 외부 라이브러리까지 mocking해주니 테스트가 문제 없이 진행되었습니다. 마지막으로 getThumbContent()에서 태그 삭제를 위해 사용하고 있는 DeleteTags 클래스의 테스트를 진행했습니다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 describe(&#39;DeleteTags 함수 테스트&#39;, () =&gt; { const deleteFn = DeleteTags.convert test(&#39;하나의 태그 삭제&#39;, () =&gt; { expect(deleteFn(&#39;&lt;div&gt;helloWorld&lt;/div&gt;&#39;)).toBe(&#39;helloWorld&#39;) expect(deleteFn(&#39;&lt;script&gt;helloWorld&lt;/script&gt;&#39;)).toBe(&#39;helloWorld&#39;) }) test(&#39;이중 중첩 태그 삭제&#39;, () =&gt; { expect(deleteFn(&#39;&lt;div&gt;&lt;p&gt;helloWorld&lt;/p&gt;&lt;/div&gt;&#39;)).toBe(&#39;helloWorld&#39;) expect(deleteFn(&#39;&lt;main&gt;&lt;h1&gt;helloWorld&lt;/h1&gt;&lt;/main&gt;&#39;)).toBe(&#39;helloWorld&#39;) }) test(&#39;이미지 태그 삭제&#39;, () =&gt; { expect(deleteFn(&#39;&lt;img src=&quot;#&quot; alt=&quot;&quot; /&gt;&#39;)).toBe(&#39;&#39;) }) }) Model 테스트의 일부분으로 이 클래스를 테스트 한 것은 아니고, 별도의 테스트 코드로 작성했습니다. 제가 테스트 코드를 작성하면서 신경을 쓰고자 했던 부분인데, 유닛 테스트는 현재 테스트하는 모듈의 결과값만을 검증합니다. 중간 과정까지 테스트를 하면 결과값이 바뀌지 않는 (클래스 또는 함수의 목적성이 바뀌지 않은) 리팩토링을 진행할때도 테스트 코드를 수정해야 할 수 있습니다. 따라서 DeleteTags의 내부 로직이 변경되었어도 리턴값이 변하지 않았다면 PostItem Model의 테스트 코드에는 영향을 주지 않도록 테스트 코드를 분리했습니다. ViewModel 유닛 테스트 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 function PostListViewModel(data: PostList): PostListVM { // 모든 게시글을 반환 function getPostList() { return data.getPostList() } // 특정 카테고리 아래의 게시글만 반환 function getPostListUnderCategory(category: string) { return data.getPostList().filter((v) =&gt; v.getPostContent().category === category) } // 인자로 넣은 개수만큼의 게시글을 반환 function cropPostList(count: number) { return data.getPostList().slice(0, count) } return { getPostList, getPostListUnderCategory, cropPostList } } 이번에는 이 ViewModel을 테스트해보겠습니다. Model 테스트에서 사용되었던 PostItem을 호출하는 함수에 따라 조건에 맞게 배열에 담아 반환해주는 ViewModel입니다. ViewModel 테스트도 Model 테스트와 다른 점은 없습니다. 그런데 number나 string과 같은 값을 반환한다면 위의 Model 테스트처럼 간단하게 테스트가 가능할텐데, 이 ViewModel은 PostItem 클래스의 인스턴스 배열을 반환합니다. 어떻게 테스트를 하면 좋을까요? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 function instanceOfPostItem(object: PostItem): object is PostItem { return ( &#39;getTitle&#39; in object &amp;&amp; &#39;getContent&#39; in object &amp;&amp; &#39;getTags&#39; in object &amp;&amp; &#39;getCreated&#39; in object &amp;&amp; &#39;getThumbContent&#39; in object ) } describe(&#39;PostList ViewModel 테스트&#39;, () =&gt; { let postList: PostListVM beforeEach(() =&gt; { postList = PostListViewModel(postData) }) test(&#39;함수 작동 테스트&#39;, () =&gt; { expect(instanceOfPostItem(postList.getPostList()[0])).toBe(true) expect(postList.getPostList()).toHaveLength(5) expect(instanceOfPostItem(postList.getPostListUnderCategory(&#39;freeboard&#39;)[0])).toBe(true) expect(postList.getPostListUnderCategory(&#39;freeboard&#39;)).toHaveLength(2) expect(postList.getPostListUnderCategory(&#39;freeboard&#39;)[0].getPostContent().category).toBe(&#39;freeboard&#39;) expect(instanceOfPostItem(postList.cropPostList(1)[0])).toBe(true) expect(postList.cropPostList(1)).toHaveLength(1) }) }) 저는 PostItem Model을 테스트 했으니 PostItem이 돌려주는 값은 문제가 없다는 전제를 두었습니다. 그래서 ViewModel이 반환한 PostItem이 어떤값을 출력하는지를 보는 것이 아니라, ViewModel이 반환한 값이 PostItem의 배열이 맞는지를 테스트하기로 했습니다. 반환된 배열의 요소가 PostItem의 속성을 전부 가지고있는지 확인하는 함수를 작성하고 그 함수가 true를 반환하면 테스트를 통과 조건에 맞는 아이템들이 배열에 전부 포함되었는지는 배열의 length 로 판단 getPostListUnderCategory() 함수의 경우, 해당 배열의 아이템들이 특정 카테고리 아래에 있어야 하기 때문에 category 속성이 원하는 값인지 확인 Model 테스트를 진행할때보다는 조금 더 고민을 거쳤지만, 위의 세가지 기준을 세우고 테스트 코드를 작성하니 금방 코드 작성을 끝낼 수 있었습니다. 마치며 테스트 코드를 작성하고 나니 아직 프로젝트가 크지 않은데도 리팩토링을 진행하다 테스트 결과가 바뀐 경험을 했습니다. 유닛 테스트를 하지 않았다면 몰랐을 변화였습니다. 이렇게 자신이 알지 못하게 코드가 바뀌면 오류를 감지하는데도 시간이 걸리고, 디버깅도 쉽지 않습니다. 작성할때는 이렇게 간단한것도 테스트 할 필요가 있을까 하다가도, 막상 실수를 마주하고 보니 테스트 코드를 촘촘하게 작성하는 일이 참 중요하다는 생각도 했습니다. 테스트를 작성해보면서 참 많은 것을 배웠다고 생각했는데, 글로 담아내려니 어렵습니다. 더 많은 공부와 경험을 통해 좋은 글을 써낼 수 있는 개발자가 되고싶다는 말과 함께 글 마치겠습니다 😊" />
<meta property="og:description" content="유닛 테스트란 어떤 단위의 모듈이 의도한 대로 동작하는지 확인하기 위한 과정입니다. 테스트 대상 단위가 정확하게 정해져있는 것은 아니지만, 이 단위의 크기를 작게 만들수록 테스트 코드를 작성하기가 쉽습니다. 데이터를 가져오는 로직과 그 데이터를 가공하는 로직, 그리고 가공한 데이터를 화면에 출력하는 로직이 하나의 컴포넌트에 전부 들어가있다고 생각해봅시다. 이 경우, 컴포넌트가 리턴하는 UI는 테스트해볼 수 있다고 하더라도, 컴포넌트 안에 얽혀있는 모든 함수들을 하나씩 뽑아내 테스트하기는 현실적으로 어렵습니다. 이러한 관점에서 MVVM 패턴은 유닛테스트를 진행하기 정말 좋은 패턴입니다. 모든 로직을 관리하던 컴포넌트에서 비즈니스 로직만을 따로 떼어내 함수 또는 클래스로 분리한 것이라고 보면 됩니다. 하나의 목적을 가지고 깔끔하게 분리된 함수와 클래스(ViewModel &amp; Model)는 View와는 독립적으로 테스트를 진행할 수 있습니다. 유닛 테스트를 진행하게 된 이유 유닛 테스트는 당장 이 기능이 잘 돌아가는지 확인해주는 역할도 하지만, 리팩토링을 진행할 때 의도치 않게 코드가 하는 기능이 바뀌는 상황을 방지해주기도 합니다. 따라서 현재 진행하고 있는 회사 프로젝트의 코드가 예상치 못하게 변경되지 않도록 테스트 코드를 작성하게 되었습니다. 여태껏 만들었던 여러개의 Model과 ViewModel의 테스트 코드를 작성하면서, 각 함수와 클래스에 맞는 테스트 코드를 작성하기 위해 많은 고민을 했습니다. 테스트는 발생할 수 있는 상황을 최대한 고려해야하기 때문에 테스트 파일마다 정말 다른 케이스를 테스트하게 됩니다. 이번 글은 특정 함수/클래스가 어떤 데이터를 받고 어떤 값을 반환하는지를 파악하고, 어떻게 테스트를 해야하는지를 고민했던 과정을 남겨보려 합니다. 테스팅 프레임워크는 Jest를 사용했습니다. Model 유닛 테스트 Model은 데이터를 받아오고 가공하는 역할을 합니다. 따라서 데이터가 들어온대로 잘 출력되는지, 가공하는 로직이 있다면 가공된 대로 형식이 잘 바뀌었는지를 테스트했습니다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 class PostItem implements PostItemType { private readonly title: string private readonly content: string private readonly tags: string[] private readonly created: string private readonly thumbContent: string constructor(raw: PostDataType) { this.title = raw.title this.content = raw.content this.tags = raw.tags this.created = TimeLang(raw.created) this.thumbContent = DeleteTags.convert(raw.content) } getTitle = () =&gt; this.title getContent = () =&gt; this.content getTags = () =&gt; this.tags getCreated = () =&gt; this.created getThumbContent = () =&gt; this.thumbContent 이 Model을 한번 테스트 해보겠습니다. 게시글 데이터를 받아와서 각 속성에 따라 출력해야 하는 값을 설정해주고 있네요. 유닛 테스트를 할 때는 목업 데이터를 사용해야 합니다. 서버 데이터를 사용하게 되면 네트워크 작업으로 인한 속도 저하, 실제 데이터의 변경, 그로 인해 테스트를 진행할때마다 나오는 결과값이 달라지는 등 여러 단점들이 생기기 때문입니다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 describe(&#39;PostItem Model 테스트&#39;, () =&gt; { let item: PostItem beforeEach(() =&gt; { item = new PostItem({ title: &#39;Hello&#39;, content: &#39;&lt;div&gt;Nice to meet you!&lt;/div&gt;&#39;, tags: [&#39;flower&#39;, &#39;tree&#39;, &#39;butterfly&#39;], created: &#39;2024-05-02T00:11:17.289362+09:00&#39;, }) }) test(&#39;기본값 출력&#39;, () =&gt; { expect(item.getTitle()).toBe(&#39;Hello&#39;) expect(item.getContent()).toBe(&#39;&lt;div&gt;Nice to meet you!&lt;/div&gt;&#39;) expect(item.getTags()).toEqual([&#39;flower&#39;, &#39;tree&#39;, &#39;butterfly&#39;]) expect(item.getCreated()).toBe(&#39;2024년 5월 2일&#39;) expect(item.getThumbContent()).toBe(&#39;Nice to meet you!&#39;) }) }) 게시글 데이터과 똑같은 형식을 가진 가짜 테스트 데이터를 만들어주었습니다. 그리고 beforeEach 메서드로 테스트를 진행하기 전마다 테스트 하고자 하는 변수값이 제가 만든 가짜 데이터로 초기화되도록 했습니다. 마지막으로 Model이 올바른 값을 리턴하는지 확인하기 위해 각 메서드의 반환값을 하나씩 빠짐없이 테스트를 돌려주었습니다. toBe, toEqual 등Matcher 함수가 결과값에 적절하게 사용되었는지도 확인해주었고요. 그런데 테스트를 돌리니 에러가 발생했습니다. 어려울게 없는 코드인데 왜 에러가 났을까 하고 문제를 찾아보니 getCreated() 메서드에서 사용하는 함수 때문이었습니다. 해당 함수에서는 i18n과 moment라는 외부 라이브러리를 사용해서 사용자의 위치 또는 사용자가 웹사이트에서 설정한 언어로 날짜를 반환해주고 있습니다. 그렇게 되면 위치나 사용자 설정에 따라 결과값이 달라지는 외부 의존성이 생기게 됩니다. 이런 현상을 방지하기 위해 jest.mock() 메서드를 사용해 외부 라이브러리를 mocking 해주어야 하는 것이지요. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 jest.mock(&#39;@src/locales/i18n&#39;, () =&gt; ({ __esModule: true, use: () =&gt; {}, init: () =&gt; {}, default: { t: (k: string) =&gt; k, language: &#39;ko&#39;, }, })) jest.mock(&#39;moment/dist/locale/ko&#39;, () =&gt; &#39;ko-kr&#39;) describe(&#39;&#39;PostItem Model 테스트&#39;&#39;, () =&gt; { // ... Model 테스트 코드 }) i18n의 기본 설정파일을 mocking하고, 테스트를 진행하는 위치나 환경에 상관없이 한국어 날짜 형식만을 반환하도록 디폴트값을 변화시켜주었습니다. 그리고 moment 라이브러리도 테스트를 진행할 때 문제없이 텍스트 변환을 할 수 있게 한국어 파일을 mocking 했습니다. 외부 라이브러리까지 mocking해주니 테스트가 문제 없이 진행되었습니다. 마지막으로 getThumbContent()에서 태그 삭제를 위해 사용하고 있는 DeleteTags 클래스의 테스트를 진행했습니다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 describe(&#39;DeleteTags 함수 테스트&#39;, () =&gt; { const deleteFn = DeleteTags.convert test(&#39;하나의 태그 삭제&#39;, () =&gt; { expect(deleteFn(&#39;&lt;div&gt;helloWorld&lt;/div&gt;&#39;)).toBe(&#39;helloWorld&#39;) expect(deleteFn(&#39;&lt;script&gt;helloWorld&lt;/script&gt;&#39;)).toBe(&#39;helloWorld&#39;) }) test(&#39;이중 중첩 태그 삭제&#39;, () =&gt; { expect(deleteFn(&#39;&lt;div&gt;&lt;p&gt;helloWorld&lt;/p&gt;&lt;/div&gt;&#39;)).toBe(&#39;helloWorld&#39;) expect(deleteFn(&#39;&lt;main&gt;&lt;h1&gt;helloWorld&lt;/h1&gt;&lt;/main&gt;&#39;)).toBe(&#39;helloWorld&#39;) }) test(&#39;이미지 태그 삭제&#39;, () =&gt; { expect(deleteFn(&#39;&lt;img src=&quot;#&quot; alt=&quot;&quot; /&gt;&#39;)).toBe(&#39;&#39;) }) }) Model 테스트의 일부분으로 이 클래스를 테스트 한 것은 아니고, 별도의 테스트 코드로 작성했습니다. 제가 테스트 코드를 작성하면서 신경을 쓰고자 했던 부분인데, 유닛 테스트는 현재 테스트하는 모듈의 결과값만을 검증합니다. 중간 과정까지 테스트를 하면 결과값이 바뀌지 않는 (클래스 또는 함수의 목적성이 바뀌지 않은) 리팩토링을 진행할때도 테스트 코드를 수정해야 할 수 있습니다. 따라서 DeleteTags의 내부 로직이 변경되었어도 리턴값이 변하지 않았다면 PostItem Model의 테스트 코드에는 영향을 주지 않도록 테스트 코드를 분리했습니다. ViewModel 유닛 테스트 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 function PostListViewModel(data: PostList): PostListVM { // 모든 게시글을 반환 function getPostList() { return data.getPostList() } // 특정 카테고리 아래의 게시글만 반환 function getPostListUnderCategory(category: string) { return data.getPostList().filter((v) =&gt; v.getPostContent().category === category) } // 인자로 넣은 개수만큼의 게시글을 반환 function cropPostList(count: number) { return data.getPostList().slice(0, count) } return { getPostList, getPostListUnderCategory, cropPostList } } 이번에는 이 ViewModel을 테스트해보겠습니다. Model 테스트에서 사용되었던 PostItem을 호출하는 함수에 따라 조건에 맞게 배열에 담아 반환해주는 ViewModel입니다. ViewModel 테스트도 Model 테스트와 다른 점은 없습니다. 그런데 number나 string과 같은 값을 반환한다면 위의 Model 테스트처럼 간단하게 테스트가 가능할텐데, 이 ViewModel은 PostItem 클래스의 인스턴스 배열을 반환합니다. 어떻게 테스트를 하면 좋을까요? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 function instanceOfPostItem(object: PostItem): object is PostItem { return ( &#39;getTitle&#39; in object &amp;&amp; &#39;getContent&#39; in object &amp;&amp; &#39;getTags&#39; in object &amp;&amp; &#39;getCreated&#39; in object &amp;&amp; &#39;getThumbContent&#39; in object ) } describe(&#39;PostList ViewModel 테스트&#39;, () =&gt; { let postList: PostListVM beforeEach(() =&gt; { postList = PostListViewModel(postData) }) test(&#39;함수 작동 테스트&#39;, () =&gt; { expect(instanceOfPostItem(postList.getPostList()[0])).toBe(true) expect(postList.getPostList()).toHaveLength(5) expect(instanceOfPostItem(postList.getPostListUnderCategory(&#39;freeboard&#39;)[0])).toBe(true) expect(postList.getPostListUnderCategory(&#39;freeboard&#39;)).toHaveLength(2) expect(postList.getPostListUnderCategory(&#39;freeboard&#39;)[0].getPostContent().category).toBe(&#39;freeboard&#39;) expect(instanceOfPostItem(postList.cropPostList(1)[0])).toBe(true) expect(postList.cropPostList(1)).toHaveLength(1) }) }) 저는 PostItem Model을 테스트 했으니 PostItem이 돌려주는 값은 문제가 없다는 전제를 두었습니다. 그래서 ViewModel이 반환한 PostItem이 어떤값을 출력하는지를 보는 것이 아니라, ViewModel이 반환한 값이 PostItem의 배열이 맞는지를 테스트하기로 했습니다. 반환된 배열의 요소가 PostItem의 속성을 전부 가지고있는지 확인하는 함수를 작성하고 그 함수가 true를 반환하면 테스트를 통과 조건에 맞는 아이템들이 배열에 전부 포함되었는지는 배열의 length 로 판단 getPostListUnderCategory() 함수의 경우, 해당 배열의 아이템들이 특정 카테고리 아래에 있어야 하기 때문에 category 속성이 원하는 값인지 확인 Model 테스트를 진행할때보다는 조금 더 고민을 거쳤지만, 위의 세가지 기준을 세우고 테스트 코드를 작성하니 금방 코드 작성을 끝낼 수 있었습니다. 마치며 테스트 코드를 작성하고 나니 아직 프로젝트가 크지 않은데도 리팩토링을 진행하다 테스트 결과가 바뀐 경험을 했습니다. 유닛 테스트를 하지 않았다면 몰랐을 변화였습니다. 이렇게 자신이 알지 못하게 코드가 바뀌면 오류를 감지하는데도 시간이 걸리고, 디버깅도 쉽지 않습니다. 작성할때는 이렇게 간단한것도 테스트 할 필요가 있을까 하다가도, 막상 실수를 마주하고 보니 테스트 코드를 촘촘하게 작성하는 일이 참 중요하다는 생각도 했습니다. 테스트를 작성해보면서 참 많은 것을 배웠다고 생각했는데, 글로 담아내려니 어렵습니다. 더 많은 공부와 경험을 통해 좋은 글을 써낼 수 있는 개발자가 되고싶다는 말과 함께 글 마치겠습니다 😊" />
<link rel="canonical" href="https://blog.by-softcorp.com/posts/react-unit-test/" />
<meta property="og:url" content="https://blog.by-softcorp.com/posts/react-unit-test/" />
<meta property="og:site_name" content="BY Soft Tech Insights" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-05-08T10:38:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ViewModel과 Model 유닛 테스트하기" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"한 재연"},"dateModified":"2024-05-08T10:38:00+09:00","datePublished":"2024-05-08T10:38:00+09:00","description":"유닛 테스트란 어떤 단위의 모듈이 의도한 대로 동작하는지 확인하기 위한 과정입니다. 테스트 대상 단위가 정확하게 정해져있는 것은 아니지만, 이 단위의 크기를 작게 만들수록 테스트 코드를 작성하기가 쉽습니다. 데이터를 가져오는 로직과 그 데이터를 가공하는 로직, 그리고 가공한 데이터를 화면에 출력하는 로직이 하나의 컴포넌트에 전부 들어가있다고 생각해봅시다. 이 경우, 컴포넌트가 리턴하는 UI는 테스트해볼 수 있다고 하더라도, 컴포넌트 안에 얽혀있는 모든 함수들을 하나씩 뽑아내 테스트하기는 현실적으로 어렵습니다. 이러한 관점에서 MVVM 패턴은 유닛테스트를 진행하기 정말 좋은 패턴입니다. 모든 로직을 관리하던 컴포넌트에서 비즈니스 로직만을 따로 떼어내 함수 또는 클래스로 분리한 것이라고 보면 됩니다. 하나의 목적을 가지고 깔끔하게 분리된 함수와 클래스(ViewModel &amp; Model)는 View와는 독립적으로 테스트를 진행할 수 있습니다. 유닛 테스트를 진행하게 된 이유 유닛 테스트는 당장 이 기능이 잘 돌아가는지 확인해주는 역할도 하지만, 리팩토링을 진행할 때 의도치 않게 코드가 하는 기능이 바뀌는 상황을 방지해주기도 합니다. 따라서 현재 진행하고 있는 회사 프로젝트의 코드가 예상치 못하게 변경되지 않도록 테스트 코드를 작성하게 되었습니다. 여태껏 만들었던 여러개의 Model과 ViewModel의 테스트 코드를 작성하면서, 각 함수와 클래스에 맞는 테스트 코드를 작성하기 위해 많은 고민을 했습니다. 테스트는 발생할 수 있는 상황을 최대한 고려해야하기 때문에 테스트 파일마다 정말 다른 케이스를 테스트하게 됩니다. 이번 글은 특정 함수/클래스가 어떤 데이터를 받고 어떤 값을 반환하는지를 파악하고, 어떻게 테스트를 해야하는지를 고민했던 과정을 남겨보려 합니다. 테스팅 프레임워크는 Jest를 사용했습니다. Model 유닛 테스트 Model은 데이터를 받아오고 가공하는 역할을 합니다. 따라서 데이터가 들어온대로 잘 출력되는지, 가공하는 로직이 있다면 가공된 대로 형식이 잘 바뀌었는지를 테스트했습니다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 class PostItem implements PostItemType { private readonly title: string private readonly content: string private readonly tags: string[] private readonly created: string private readonly thumbContent: string constructor(raw: PostDataType) { this.title = raw.title this.content = raw.content this.tags = raw.tags this.created = TimeLang(raw.created) this.thumbContent = DeleteTags.convert(raw.content) } getTitle = () =&gt; this.title getContent = () =&gt; this.content getTags = () =&gt; this.tags getCreated = () =&gt; this.created getThumbContent = () =&gt; this.thumbContent 이 Model을 한번 테스트 해보겠습니다. 게시글 데이터를 받아와서 각 속성에 따라 출력해야 하는 값을 설정해주고 있네요. 유닛 테스트를 할 때는 목업 데이터를 사용해야 합니다. 서버 데이터를 사용하게 되면 네트워크 작업으로 인한 속도 저하, 실제 데이터의 변경, 그로 인해 테스트를 진행할때마다 나오는 결과값이 달라지는 등 여러 단점들이 생기기 때문입니다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 describe(&#39;PostItem Model 테스트&#39;, () =&gt; { let item: PostItem beforeEach(() =&gt; { item = new PostItem({ title: &#39;Hello&#39;, content: &#39;&lt;div&gt;Nice to meet you!&lt;/div&gt;&#39;, tags: [&#39;flower&#39;, &#39;tree&#39;, &#39;butterfly&#39;], created: &#39;2024-05-02T00:11:17.289362+09:00&#39;, }) }) test(&#39;기본값 출력&#39;, () =&gt; { expect(item.getTitle()).toBe(&#39;Hello&#39;) expect(item.getContent()).toBe(&#39;&lt;div&gt;Nice to meet you!&lt;/div&gt;&#39;) expect(item.getTags()).toEqual([&#39;flower&#39;, &#39;tree&#39;, &#39;butterfly&#39;]) expect(item.getCreated()).toBe(&#39;2024년 5월 2일&#39;) expect(item.getThumbContent()).toBe(&#39;Nice to meet you!&#39;) }) }) 게시글 데이터과 똑같은 형식을 가진 가짜 테스트 데이터를 만들어주었습니다. 그리고 beforeEach 메서드로 테스트를 진행하기 전마다 테스트 하고자 하는 변수값이 제가 만든 가짜 데이터로 초기화되도록 했습니다. 마지막으로 Model이 올바른 값을 리턴하는지 확인하기 위해 각 메서드의 반환값을 하나씩 빠짐없이 테스트를 돌려주었습니다. toBe, toEqual 등Matcher 함수가 결과값에 적절하게 사용되었는지도 확인해주었고요. 그런데 테스트를 돌리니 에러가 발생했습니다. 어려울게 없는 코드인데 왜 에러가 났을까 하고 문제를 찾아보니 getCreated() 메서드에서 사용하는 함수 때문이었습니다. 해당 함수에서는 i18n과 moment라는 외부 라이브러리를 사용해서 사용자의 위치 또는 사용자가 웹사이트에서 설정한 언어로 날짜를 반환해주고 있습니다. 그렇게 되면 위치나 사용자 설정에 따라 결과값이 달라지는 외부 의존성이 생기게 됩니다. 이런 현상을 방지하기 위해 jest.mock() 메서드를 사용해 외부 라이브러리를 mocking 해주어야 하는 것이지요. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 jest.mock(&#39;@src/locales/i18n&#39;, () =&gt; ({ __esModule: true, use: () =&gt; {}, init: () =&gt; {}, default: { t: (k: string) =&gt; k, language: &#39;ko&#39;, }, })) jest.mock(&#39;moment/dist/locale/ko&#39;, () =&gt; &#39;ko-kr&#39;) describe(&#39;&#39;PostItem Model 테스트&#39;&#39;, () =&gt; { // ... Model 테스트 코드 }) i18n의 기본 설정파일을 mocking하고, 테스트를 진행하는 위치나 환경에 상관없이 한국어 날짜 형식만을 반환하도록 디폴트값을 변화시켜주었습니다. 그리고 moment 라이브러리도 테스트를 진행할 때 문제없이 텍스트 변환을 할 수 있게 한국어 파일을 mocking 했습니다. 외부 라이브러리까지 mocking해주니 테스트가 문제 없이 진행되었습니다. 마지막으로 getThumbContent()에서 태그 삭제를 위해 사용하고 있는 DeleteTags 클래스의 테스트를 진행했습니다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 describe(&#39;DeleteTags 함수 테스트&#39;, () =&gt; { const deleteFn = DeleteTags.convert test(&#39;하나의 태그 삭제&#39;, () =&gt; { expect(deleteFn(&#39;&lt;div&gt;helloWorld&lt;/div&gt;&#39;)).toBe(&#39;helloWorld&#39;) expect(deleteFn(&#39;&lt;script&gt;helloWorld&lt;/script&gt;&#39;)).toBe(&#39;helloWorld&#39;) }) test(&#39;이중 중첩 태그 삭제&#39;, () =&gt; { expect(deleteFn(&#39;&lt;div&gt;&lt;p&gt;helloWorld&lt;/p&gt;&lt;/div&gt;&#39;)).toBe(&#39;helloWorld&#39;) expect(deleteFn(&#39;&lt;main&gt;&lt;h1&gt;helloWorld&lt;/h1&gt;&lt;/main&gt;&#39;)).toBe(&#39;helloWorld&#39;) }) test(&#39;이미지 태그 삭제&#39;, () =&gt; { expect(deleteFn(&#39;&lt;img src=&quot;#&quot; alt=&quot;&quot; /&gt;&#39;)).toBe(&#39;&#39;) }) }) Model 테스트의 일부분으로 이 클래스를 테스트 한 것은 아니고, 별도의 테스트 코드로 작성했습니다. 제가 테스트 코드를 작성하면서 신경을 쓰고자 했던 부분인데, 유닛 테스트는 현재 테스트하는 모듈의 결과값만을 검증합니다. 중간 과정까지 테스트를 하면 결과값이 바뀌지 않는 (클래스 또는 함수의 목적성이 바뀌지 않은) 리팩토링을 진행할때도 테스트 코드를 수정해야 할 수 있습니다. 따라서 DeleteTags의 내부 로직이 변경되었어도 리턴값이 변하지 않았다면 PostItem Model의 테스트 코드에는 영향을 주지 않도록 테스트 코드를 분리했습니다. ViewModel 유닛 테스트 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 function PostListViewModel(data: PostList): PostListVM { // 모든 게시글을 반환 function getPostList() { return data.getPostList() } // 특정 카테고리 아래의 게시글만 반환 function getPostListUnderCategory(category: string) { return data.getPostList().filter((v) =&gt; v.getPostContent().category === category) } // 인자로 넣은 개수만큼의 게시글을 반환 function cropPostList(count: number) { return data.getPostList().slice(0, count) } return { getPostList, getPostListUnderCategory, cropPostList } } 이번에는 이 ViewModel을 테스트해보겠습니다. Model 테스트에서 사용되었던 PostItem을 호출하는 함수에 따라 조건에 맞게 배열에 담아 반환해주는 ViewModel입니다. ViewModel 테스트도 Model 테스트와 다른 점은 없습니다. 그런데 number나 string과 같은 값을 반환한다면 위의 Model 테스트처럼 간단하게 테스트가 가능할텐데, 이 ViewModel은 PostItem 클래스의 인스턴스 배열을 반환합니다. 어떻게 테스트를 하면 좋을까요? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 function instanceOfPostItem(object: PostItem): object is PostItem { return ( &#39;getTitle&#39; in object &amp;&amp; &#39;getContent&#39; in object &amp;&amp; &#39;getTags&#39; in object &amp;&amp; &#39;getCreated&#39; in object &amp;&amp; &#39;getThumbContent&#39; in object ) } describe(&#39;PostList ViewModel 테스트&#39;, () =&gt; { let postList: PostListVM beforeEach(() =&gt; { postList = PostListViewModel(postData) }) test(&#39;함수 작동 테스트&#39;, () =&gt; { expect(instanceOfPostItem(postList.getPostList()[0])).toBe(true) expect(postList.getPostList()).toHaveLength(5) expect(instanceOfPostItem(postList.getPostListUnderCategory(&#39;freeboard&#39;)[0])).toBe(true) expect(postList.getPostListUnderCategory(&#39;freeboard&#39;)).toHaveLength(2) expect(postList.getPostListUnderCategory(&#39;freeboard&#39;)[0].getPostContent().category).toBe(&#39;freeboard&#39;) expect(instanceOfPostItem(postList.cropPostList(1)[0])).toBe(true) expect(postList.cropPostList(1)).toHaveLength(1) }) }) 저는 PostItem Model을 테스트 했으니 PostItem이 돌려주는 값은 문제가 없다는 전제를 두었습니다. 그래서 ViewModel이 반환한 PostItem이 어떤값을 출력하는지를 보는 것이 아니라, ViewModel이 반환한 값이 PostItem의 배열이 맞는지를 테스트하기로 했습니다. 반환된 배열의 요소가 PostItem의 속성을 전부 가지고있는지 확인하는 함수를 작성하고 그 함수가 true를 반환하면 테스트를 통과 조건에 맞는 아이템들이 배열에 전부 포함되었는지는 배열의 length 로 판단 getPostListUnderCategory() 함수의 경우, 해당 배열의 아이템들이 특정 카테고리 아래에 있어야 하기 때문에 category 속성이 원하는 값인지 확인 Model 테스트를 진행할때보다는 조금 더 고민을 거쳤지만, 위의 세가지 기준을 세우고 테스트 코드를 작성하니 금방 코드 작성을 끝낼 수 있었습니다. 마치며 테스트 코드를 작성하고 나니 아직 프로젝트가 크지 않은데도 리팩토링을 진행하다 테스트 결과가 바뀐 경험을 했습니다. 유닛 테스트를 하지 않았다면 몰랐을 변화였습니다. 이렇게 자신이 알지 못하게 코드가 바뀌면 오류를 감지하는데도 시간이 걸리고, 디버깅도 쉽지 않습니다. 작성할때는 이렇게 간단한것도 테스트 할 필요가 있을까 하다가도, 막상 실수를 마주하고 보니 테스트 코드를 촘촘하게 작성하는 일이 참 중요하다는 생각도 했습니다. 테스트를 작성해보면서 참 많은 것을 배웠다고 생각했는데, 글로 담아내려니 어렵습니다. 더 많은 공부와 경험을 통해 좋은 글을 써낼 수 있는 개발자가 되고싶다는 말과 함께 글 마치겠습니다 😊","headline":"ViewModel과 Model 유닛 테스트하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.by-softcorp.com/posts/react-unit-test/"},"url":"https://blog.by-softcorp.com/posts/react-unit-test/"}</script>
<!-- End Jekyll SEO tag -->


  <title>ViewModel과 Model 유닛 테스트하기 | BY Soft Tech Insights
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="BY Soft Tech Insights">
<meta name="application-name" content="BY Soft Tech Insights">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/commons/bi.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">BY Soft Tech Insights</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Building the Future with the Power of Code, Our Story Awaits You Here.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/BY-SoftCorp"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['dev','by-softcorp.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>ViewModel과 Model 유닛 테스트하기</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>ViewModel과 Model 유닛 테스트하기</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1715132280"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  May  8, 2024
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                한 재연
                
              
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2874 words"
>
  <em>15 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p>유닛 테스트란 어떤 단위의 모듈이 의도한 대로 동작하는지 확인하기 위한 과정입니다. 테스트 대상 단위가 정확하게 정해져있는 것은 아니지만, 이 단위의 크기를 작게 만들수록 테스트 코드를 작성하기가 쉽습니다. 데이터를 가져오는 로직과 그 데이터를 가공하는 로직, 그리고 가공한 데이터를 화면에 출력하는 로직이 하나의 컴포넌트에 전부 들어가있다고 생각해봅시다. 이 경우, 컴포넌트가 리턴하는 UI는 테스트해볼 수 있다고 하더라도, 컴포넌트 안에 얽혀있는 모든 함수들을 하나씩 뽑아내 테스트하기는 현실적으로 어렵습니다. 이러한 관점에서 <code class="language-plaintext highlighter-rouge">MVVM</code> 패턴은 유닛테스트를 진행하기 정말 좋은 패턴입니다. 모든 로직을 관리하던 컴포넌트에서 비즈니스 로직만을 따로 떼어내 함수 또는 클래스로 분리한 것이라고 보면 됩니다. 하나의 목적을 가지고 깔끔하게 분리된 함수와 클래스(ViewModel &amp; Model)는 View와는 독립적으로 테스트를 진행할 수 있습니다.</p>

<h2 id="유닛-테스트를-진행하게-된-이유"><span class="me-2">유닛 테스트를 진행하게 된 이유</span><a href="#유닛-테스트를-진행하게-된-이유" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>유닛 테스트는 당장 이 기능이 잘 돌아가는지 확인해주는 역할도 하지만, 리팩토링을 진행할 때 의도치 않게 코드가 하는 기능이 바뀌는 상황을 방지해주기도 합니다. 따라서 현재 진행하고 있는 회사 프로젝트의 코드가 예상치 못하게 변경되지 않도록 테스트 코드를 작성하게 되었습니다.</p>

<p>여태껏 만들었던 여러개의 Model과 ViewModel의 테스트 코드를 작성하면서, 각 함수와 클래스에 맞는 테스트 코드를 작성하기 위해 많은 고민을 했습니다. 테스트는 발생할 수 있는 상황을 최대한 고려해야하기 때문에 테스트 파일마다 정말 다른 케이스를 테스트하게 됩니다. 이번 글은 특정 함수/클래스가 어떤 데이터를 받고 어떤 값을 반환하는지를 파악하고, 어떻게 테스트를 해야하는지를 고민했던 과정을 남겨보려 합니다. 테스팅 프레임워크는 <code class="language-plaintext highlighter-rouge">Jest</code>를 사용했습니다.</p>

<h2 id="model-유닛-테스트"><span class="me-2">Model 유닛 테스트</span><a href="#model-유닛-테스트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Model은 데이터를 받아오고 가공하는 역할을 합니다. 따라서 데이터가 들어온대로 잘 출력되는지, 가공하는 로직이 있다면 가공된 대로 형식이 잘 바뀌었는지를 테스트했습니다.</p>

<div class="language-typescript highlighter-rouge"><div class="code-header">
        <span data-label-text="TypeScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nx">PostItem</span> <span class="k">implements</span> <span class="nx">PostItemType</span> <span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="nx">title</span><span class="p">:</span> <span class="kr">string</span>

    <span class="k">private</span> <span class="k">readonly</span> <span class="nx">content</span><span class="p">:</span> <span class="kr">string</span>

    <span class="k">private</span> <span class="k">readonly</span> <span class="nx">tags</span><span class="p">:</span> <span class="kr">string</span><span class="p">[]</span>

    <span class="k">private</span> <span class="k">readonly</span> <span class="nx">created</span><span class="p">:</span> <span class="kr">string</span>

    <span class="k">private</span> <span class="k">readonly</span> <span class="nx">thumbContent</span><span class="p">:</span> <span class="kr">string</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="nx">raw</span><span class="p">:</span> <span class="nx">PostDataType</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">raw</span><span class="p">.</span><span class="nx">title</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">content</span> <span class="o">=</span> <span class="nx">raw</span><span class="p">.</span><span class="nx">content</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tags</span> <span class="o">=</span> <span class="nx">raw</span><span class="p">.</span><span class="nx">tags</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">created</span> <span class="o">=</span> <span class="nx">TimeLang</span><span class="p">(</span><span class="nx">raw</span><span class="p">.</span><span class="nx">created</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">thumbContent</span> <span class="o">=</span> <span class="nx">DeleteTags</span><span class="p">.</span><span class="nx">convert</span><span class="p">(</span><span class="nx">raw</span><span class="p">.</span><span class="nx">content</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">getTitle</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">title</span>

    <span class="nx">getContent</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">content</span>

    <span class="nx">getTags</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">tags</span>

    <span class="nx">getCreated</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">created</span>

    <span class="nx">getThumbContent</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">thumbContent</span>
</pre></td></tr></tbody></table></code></div></div>
<p>이 Model을 한번 테스트 해보겠습니다. 게시글 데이터를 받아와서 각 속성에 따라 출력해야 하는 값을 설정해주고 있네요.</p>

<p>유닛 테스트를 할 때는 목업 데이터를 사용해야 합니다. 서버 데이터를 사용하게 되면 네트워크 작업으로 인한 속도 저하, 실제 데이터의 변경, 그로 인해 테스트를 진행할때마다 나오는 결과값이 달라지는 등 여러 단점들이 생기기 때문입니다.</p>
<div class="language-typescript highlighter-rouge"><div class="code-header">
        <span data-label-text="TypeScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">PostItem Model 테스트</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="na">item</span><span class="p">:</span> <span class="nx">PostItem</span>

    <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PostItem</span><span class="p">({</span>
            <span class="na">title</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Hello</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">content</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&lt;div&gt;Nice to meet you!&lt;/div&gt;</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">tags</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">flower</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">tree</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">butterfly</span><span class="dl">'</span><span class="p">],</span>
            <span class="na">created</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2024-05-02T00:11:17.289362+09:00</span><span class="dl">'</span><span class="p">,</span>
        <span class="p">})</span>
    <span class="p">})</span>

    <span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">기본값 출력</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">getTitle</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">getContent</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;div&gt;Nice to meet you!&lt;/div&gt;</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">getTags</span><span class="p">()).</span><span class="nx">toEqual</span><span class="p">([</span><span class="dl">'</span><span class="s1">flower</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">tree</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">butterfly</span><span class="dl">'</span><span class="p">])</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">getCreated</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">2024년 5월 2일</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">getThumbContent</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Nice to meet you!</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">})</span>
</pre></td></tr></tbody></table></code></div></div>
<p>게시글 데이터과 똑같은 형식을 가진 가짜 테스트 데이터를 만들어주었습니다. 그리고 <code class="language-plaintext highlighter-rouge">beforeEach</code> 메서드로 테스트를 진행하기 전마다 테스트 하고자 하는 변수값이 제가 만든 가짜 데이터로 초기화되도록 했습니다. 마지막으로 Model이 올바른 값을 리턴하는지 확인하기 위해 각 메서드의 반환값을 하나씩 빠짐없이 테스트를 돌려주었습니다. <code class="language-plaintext highlighter-rouge">toBe</code>, <code class="language-plaintext highlighter-rouge">toEqual</code> 등<code class="language-plaintext highlighter-rouge">Matcher</code> 함수가 결과값에 적절하게 사용되었는지도 확인해주었고요.</p>

<p><a href="/assets/img/references/react-unit-test-img-1.png" class="popup img-link  shimmer"><img src="/assets/img/references/react-unit-test-img-1.png" alt="Reference 오류" loading="lazy"></a></p>

<p>그런데 테스트를 돌리니 에러가 발생했습니다. 어려울게 없는 코드인데 왜 에러가 났을까 하고 문제를 찾아보니 <code class="language-plaintext highlighter-rouge">getCreated()</code> 메서드에서 사용하는 함수 때문이었습니다. 해당 함수에서는 <code class="language-plaintext highlighter-rouge">i18n</code>과 <code class="language-plaintext highlighter-rouge">moment</code>라는 외부 라이브러리를 사용해서 사용자의 위치 또는 사용자가 웹사이트에서 설정한 언어로 날짜를 반환해주고 있습니다. 그렇게 되면 위치나 사용자 설정에 따라 결과값이 달라지는 외부 의존성이 생기게 됩니다. 이런 현상을 방지하기 위해 <code class="language-plaintext highlighter-rouge">jest.mock()</code> 메서드를 사용해 외부 라이브러리를 mocking 해주어야 하는 것이지요.</p>

<div class="language-typescript highlighter-rouge"><div class="code-header">
        <span data-label-text="TypeScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="dl">'</span><span class="s1">@src/locales/i18n</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
    <span class="na">__esModule</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">use</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{},</span>
    <span class="na">init</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{},</span>
    <span class="na">default</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">t</span><span class="p">:</span> <span class="p">(</span><span class="na">k</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">k</span><span class="p">,</span>
        <span class="na">language</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ko</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}))</span>

<span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="dl">'</span><span class="s1">moment/dist/locale/ko</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="dl">'</span><span class="s1">ko-kr</span><span class="dl">'</span><span class="p">)</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">''</span><span class="nx">PostItem</span> <span class="nx">Model</span> <span class="nx">테스트</span><span class="dl">''</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ... Model 테스트 코드</span>
<span class="p">})</span>
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">i18n</code>의 기본 설정파일을 mocking하고, 테스트를 진행하는 위치나 환경에 상관없이 한국어 날짜 형식만을 반환하도록 디폴트값을 변화시켜주었습니다. 그리고 <code class="language-plaintext highlighter-rouge">moment</code> 라이브러리도 테스트를 진행할 때 문제없이 텍스트 변환을 할 수 있게 한국어 파일을 mocking 했습니다. 외부 라이브러리까지 mocking해주니 테스트가 문제 없이 진행되었습니다.</p>

<p>마지막으로 <code class="language-plaintext highlighter-rouge">getThumbContent()</code>에서 태그 삭제를 위해 사용하고 있는 <code class="language-plaintext highlighter-rouge">DeleteTags</code> 클래스의 테스트를 진행했습니다.</p>
<div class="language-typescript highlighter-rouge"><div class="code-header">
        <span data-label-text="TypeScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">DeleteTags 함수 테스트</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">deleteFn</span> <span class="o">=</span> <span class="nx">DeleteTags</span><span class="p">.</span><span class="nx">convert</span>

    <span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">하나의 태그 삭제</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">deleteFn</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;div&gt;helloWorld&lt;/div&gt;</span><span class="dl">'</span><span class="p">)).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">helloWorld</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">deleteFn</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;script&gt;helloWorld&lt;/script&gt;</span><span class="dl">'</span><span class="p">)).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">helloWorld</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">이중 중첩 태그 삭제</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">deleteFn</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;div&gt;&lt;p&gt;helloWorld&lt;/p&gt;&lt;/div&gt;</span><span class="dl">'</span><span class="p">)).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">helloWorld</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">deleteFn</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;main&gt;&lt;h1&gt;helloWorld&lt;/h1&gt;&lt;/main&gt;</span><span class="dl">'</span><span class="p">)).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">helloWorld</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">이미지 태그 삭제</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">deleteFn</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src="#" alt="" /&gt;</span><span class="dl">'</span><span class="p">)).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">''</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">})</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Model 테스트의 일부분으로 이 클래스를 테스트 한 것은 아니고, 별도의 테스트 코드로 작성했습니다. 제가 테스트 코드를 작성하면서 신경을 쓰고자 했던 부분인데, 유닛 테스트는 현재 테스트하는 모듈의 결과값만을 검증합니다. 중간 과정까지 테스트를 하면 결과값이 바뀌지 않는 (클래스 또는 함수의 목적성이 바뀌지 않은) 리팩토링을 진행할때도 테스트 코드를 수정해야 할 수 있습니다. 따라서 <code class="language-plaintext highlighter-rouge">DeleteTags</code>의 내부 로직이 변경되었어도 리턴값이 변하지 않았다면 <code class="language-plaintext highlighter-rouge">PostItem</code> Model의 테스트 코드에는 영향을 주지 않도록 테스트 코드를 분리했습니다.</p>

<h2 id="viewmodel-유닛-테스트"><span class="me-2">ViewModel 유닛 테스트</span><a href="#viewmodel-유닛-테스트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<div class="language-typescript highlighter-rouge"><div class="code-header">
        <span data-label-text="TypeScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">PostListViewModel</span><span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="nx">PostList</span><span class="p">):</span> <span class="nx">PostListVM</span> <span class="p">{</span>
    <span class="c1">// 모든 게시글을 반환</span>
    <span class="kd">function</span> <span class="nx">getPostList</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nx">getPostList</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="c1">// 특정 카테고리 아래의 게시글만 반환</span>
    <span class="kd">function</span> <span class="nx">getPostListUnderCategory</span><span class="p">(</span><span class="nx">category</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nx">getPostList</span><span class="p">().</span><span class="nx">filter</span><span class="p">((</span><span class="nx">v</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">getPostContent</span><span class="p">().</span><span class="nx">category</span> <span class="o">===</span> <span class="nx">category</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// 인자로 넣은 개수만큼의 게시글을 반환</span>
    <span class="kd">function</span> <span class="nx">cropPostList</span><span class="p">(</span><span class="nx">count</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nx">getPostList</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">count</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span> <span class="nx">getPostList</span><span class="p">,</span> <span class="nx">getPostListUnderCategory</span><span class="p">,</span> <span class="nx">cropPostList</span> <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>이번에는 이 ViewModel을 테스트해보겠습니다. Model 테스트에서 사용되었던 <code class="language-plaintext highlighter-rouge">PostItem</code>을 호출하는 함수에 따라 조건에 맞게 배열에 담아 반환해주는 ViewModel입니다.</p>

<p>ViewModel 테스트도 Model 테스트와 다른 점은 없습니다. 그런데 <code class="language-plaintext highlighter-rouge">number</code>나 <code class="language-plaintext highlighter-rouge">string</code>과 같은 값을 반환한다면 위의 Model 테스트처럼 간단하게 테스트가 가능할텐데, 이 ViewModel은 <code class="language-plaintext highlighter-rouge">PostItem</code> 클래스의 인스턴스 배열을 반환합니다. 어떻게 테스트를 하면 좋을까요?</p>
<div class="language-typescript highlighter-rouge"><div class="code-header">
        <span data-label-text="TypeScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">instanceOfPostItem</span><span class="p">(</span><span class="nx">object</span><span class="p">:</span> <span class="nx">PostItem</span><span class="p">):</span> <span class="nx">object</span> <span class="k">is</span> <span class="nx">PostItem</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="dl">'</span><span class="s1">getTitle</span><span class="dl">'</span> <span class="k">in</span> <span class="nx">object</span> <span class="o">&amp;&amp;</span>
        <span class="dl">'</span><span class="s1">getContent</span><span class="dl">'</span> <span class="k">in</span> <span class="nx">object</span> <span class="o">&amp;&amp;</span>
        <span class="dl">'</span><span class="s1">getTags</span><span class="dl">'</span> <span class="k">in</span> <span class="nx">object</span> <span class="o">&amp;&amp;</span>
        <span class="dl">'</span><span class="s1">getCreated</span><span class="dl">'</span> <span class="k">in</span> <span class="nx">object</span> <span class="o">&amp;&amp;</span>
        <span class="dl">'</span><span class="s1">getThumbContent</span><span class="dl">'</span> <span class="k">in</span> <span class="nx">object</span>
    <span class="p">)</span>
<span class="p">}</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">PostList ViewModel 테스트</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="na">postList</span><span class="p">:</span> <span class="nx">PostListVM</span>

    <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">postList</span> <span class="o">=</span> <span class="nx">PostListViewModel</span><span class="p">(</span><span class="nx">postData</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">함수 작동 테스트</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">instanceOfPostItem</span><span class="p">(</span><span class="nx">postList</span><span class="p">.</span><span class="nx">getPostList</span><span class="p">()[</span><span class="mi">0</span><span class="p">])).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">postList</span><span class="p">.</span><span class="nx">getPostList</span><span class="p">()).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

        <span class="nx">expect</span><span class="p">(</span><span class="nx">instanceOfPostItem</span><span class="p">(</span><span class="nx">postList</span><span class="p">.</span><span class="nx">getPostListUnderCategory</span><span class="p">(</span><span class="dl">'</span><span class="s1">freeboard</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">])).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">postList</span><span class="p">.</span><span class="nx">getPostListUnderCategory</span><span class="p">(</span><span class="dl">'</span><span class="s1">freeboard</span><span class="dl">'</span><span class="p">)).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">postList</span><span class="p">.</span><span class="nx">getPostListUnderCategory</span><span class="p">(</span><span class="dl">'</span><span class="s1">freeboard</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getPostContent</span><span class="p">().</span><span class="nx">category</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">freeboard</span><span class="dl">'</span><span class="p">)</span>

        <span class="nx">expect</span><span class="p">(</span><span class="nx">instanceOfPostItem</span><span class="p">(</span><span class="nx">postList</span><span class="p">.</span><span class="nx">cropPostList</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">postList</span><span class="p">.</span><span class="nx">cropPostList</span><span class="p">(</span><span class="mi">1</span><span class="p">)).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">})</span>
</pre></td></tr></tbody></table></code></div></div>
<p>저는 <code class="language-plaintext highlighter-rouge">PostItem</code> Model을 테스트 했으니 <code class="language-plaintext highlighter-rouge">PostItem</code>이 돌려주는 값은 문제가 없다는 전제를 두었습니다. 그래서 ViewModel이 반환한 <code class="language-plaintext highlighter-rouge">PostItem</code>이 어떤값을 출력하는지를 보는 것이 아니라, ViewModel이 반환한 값이 <code class="language-plaintext highlighter-rouge">PostItem</code>의 배열이 맞는지를 테스트하기로 했습니다.</p>

<ol>
  <li>반환된 배열의 요소가 <code class="language-plaintext highlighter-rouge">PostItem</code>의 속성을 전부 가지고있는지 확인하는 함수를 작성하고 그 함수가 <code class="language-plaintext highlighter-rouge">true</code>를 반환하면 테스트를 통과</li>
  <li>조건에 맞는 아이템들이 배열에 전부 포함되었는지는 배열의 <code class="language-plaintext highlighter-rouge">length</code> 로 판단</li>
  <li><code class="language-plaintext highlighter-rouge">getPostListUnderCategory()</code> 함수의 경우, 해당 배열의 아이템들이 특정 카테고리 아래에 있어야 하기 때문에 <code class="language-plaintext highlighter-rouge">category</code> 속성이 원하는 값인지 확인</li>
</ol>

<p>Model 테스트를 진행할때보다는 조금 더 고민을 거쳤지만, 위의 세가지 기준을 세우고 테스트 코드를 작성하니 금방 코드 작성을 끝낼 수 있었습니다.</p>

<h2 id="마치며"><span class="me-2">마치며</span><a href="#마치며" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>테스트 코드를 작성하고 나니 아직 프로젝트가 크지 않은데도 리팩토링을 진행하다 테스트 결과가 바뀐 경험을 했습니다. 유닛 테스트를 하지 않았다면 몰랐을 변화였습니다. 이렇게 자신이 알지 못하게 코드가 바뀌면 오류를 감지하는데도 시간이 걸리고, 디버깅도 쉽지 않습니다. 작성할때는 이렇게 간단한것도 테스트 할 필요가 있을까 하다가도, 막상 실수를 마주하고 보니 테스트 코드를 촘촘하게 작성하는 일이 참 중요하다는 생각도 했습니다. 테스트를 작성해보면서 참 많은 것을 배웠다고 생각했는데, 글로 담아내려니 어렵습니다. 더 많은 공부와 경험을 통해 좋은 글을 써낼 수 있는 개발자가 되고싶다는 말과 함께 글 마치겠습니다 😊</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/typescript/">typescript</a>,
          <a href="/categories/react/">react</a>,
          <a href="/categories/frontend/">frontend</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/unit-test/"
            class="post-tag no-text-decoration"
          >unit-test</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=ViewModel%EA%B3%BC%20Model%20%EC%9C%A0%EB%8B%9B%20%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0%20-%20BY%20Soft%20Tech%20Insights&url=https%3A%2F%2Fblog.by-softcorp.com%2Fposts%2Freact-unit-test%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=ViewModel%EA%B3%BC%20Model%20%EC%9C%A0%EB%8B%9B%20%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0%20-%20BY%20Soft%20Tech%20Insights&u=https%3A%2F%2Fblog.by-softcorp.com%2Fposts%2Freact-unit-test%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fblog.by-softcorp.com%2Fposts%2Freact-unit-test%2F&text=ViewModel%EA%B3%BC%20Model%20%EC%9C%A0%EB%8B%9B%20%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0%20-%20BY%20Soft%20Tech%20Insights" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/react-unit-test/">ViewModel과 Model 유닛 테스트하기</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/reuse-viewmodel/">공통 기능을 가진 ViewModel 만들어 재사용하기</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/apply-mvvm-design/">신입 프론트엔드 개발자의 MVVM 패턴 적용기</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/fast-api-db-test/">FastAPI와 SQLAlchemy 환경에서 Database Test</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/annotated-enum/">Python 열거형과 SQLAlchemy</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/design-pattern/">design-pattern</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fastapi/">fastapi</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/mvvm/">mvvm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sqlalchemy/">sqlalchemy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/enum/">enum</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pydantic/">pydantic</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/unit-test/">unit-test</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/unittest/">unittest</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/validate/">validate</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  
    
  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/apply-mvvm-design/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1711417620"
  data-df="ll"
  
>
  Mar 26, 2024
</time>

              <h4 class="pt-0 my-2">신입 프론트엔드 개발자의 MVVM 패턴 적용기</h4>
              <div class="text-muted">
                <p>
                  





                  MVVM 패턴은 디자인 패턴의 한 종류로, Model, View, ViewModel을 사용해 UI 관련 로직과 비즈니스 로직을 명확하게 분리합니다. 취업을 준비하던 시기에 진행했던 토이 프로젝트는 규모가 작아 이러한 패턴을 적용할 필요성을 느끼지 못했습니다. 그러나 프론트엔드 개발자로 일을 시작하고 사용자들이 사용할 실제 서비스를 제작하며, 코드의 유...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/reuse-viewmodel/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1714094160"
  data-df="ll"
  
>
  Apr 26, 2024
</time>

              <h4 class="pt-0 my-2">공통 기능을 가진 ViewModel 만들어 재사용하기</h4>
              <div class="text-muted">
                <p>
                  





                  ViewModel을 재사용하기 위한 고찰

이전 블로그 글에서 MVVM 패턴을 적용했던 과정에 대해 남겨보았습니다. 그 이후로도 저는 여러가지 ViewModel과 Model을 구현해보았는데요, 매일 마주하는 코드인데도 불구하고 고쳐야 할 점이 매번 새롭게 보이고 있습니다. 쉽지 않은 내용인 만큼 아직도 MVVM 패턴에 익숙해지는 중인 것 같습니다. 최...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/reuse-viewmodel/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>공통 기능을 가진 ViewModel 만들어 재사용하기</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2024</time>
    <a href="https://github.com/BY-SoftCorp">BY-Soft</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/design-pattern/">design-pattern</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fastapi/">fastapi</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/mvvm/">mvvm</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sqlalchemy/">sqlalchemy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/enum/">enum</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pydantic/">pydantic</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/unit-test/">unit-test</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/unittest/">unittest</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/validate/">validate</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

